/*! For license information please see main.356d87ff.iframe.bundle.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{20:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TabsterAttributeName",(function(){return TabsterAttributeName})),__webpack_require__.d(__webpack_exports__,"TabsterDummyInputAttributeName",(function(){return TabsterDummyInputAttributeName})),__webpack_require__.d(__webpack_exports__,"DeloserEventName",(function(){return DeloserEventName})),__webpack_require__.d(__webpack_exports__,"ModalizerEventName",(function(){return ModalizerEventName})),__webpack_require__.d(__webpack_exports__,"MoverEventName",(function(){return MoverEventName})),__webpack_require__.d(__webpack_exports__,"ObservedElementAccesibilities",(function(){return ObservedElementAccesibilities})),__webpack_require__.d(__webpack_exports__,"RestoreFocusOrders",(function(){return RestoreFocusOrders})),__webpack_require__.d(__webpack_exports__,"Visibilities",(function(){return Visibilities})),__webpack_require__.d(__webpack_exports__,"MoverDirections",(function(){return MoverDirections})),__webpack_require__.d(__webpack_exports__,"GroupperTabbabilities",(function(){return GroupperTabbabilities}));var TabsterAttributeName="data-tabster",TabsterDummyInputAttributeName="data-tabster-dummy",DeloserEventName="tabster:deloser",ModalizerEventName="tabster:modalizer",MoverEventName="tabster:mover",ObservedElementAccesibilities={Any:0,Accessible:1,Focusable:2},RestoreFocusOrders={History:0,DeloserDefault:1,RootDefault:2,DeloserFirst:3,RootFirst:4},Visibilities={Invisible:0,PartiallyVisible:1,Visible:2},MoverDirections={Both:0,Vertical:1,Horizontal:2,Grid:3},GroupperTabbabilities={Unlimited:0,Limited:1,LimitedTrapFocus:2}},309:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(process){__webpack_require__.d(__webpack_exports__,"a",(function(){return Types})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getTabsterAttribute}));__webpack_require__(42),__webpack_require__(22),__webpack_require__(146),__webpack_require__(43),__webpack_require__(211),__webpack_require__(10),__webpack_require__(15),__webpack_require__(14),__webpack_require__(17),__webpack_require__(48),__webpack_require__(437),__webpack_require__(442),__webpack_require__(443),__webpack_require__(444),__webpack_require__(445),__webpack_require__(446),__webpack_require__(447),__webpack_require__(448),__webpack_require__(449),__webpack_require__(450),__webpack_require__(451),__webpack_require__(452),__webpack_require__(453),__webpack_require__(454),__webpack_require__(455),__webpack_require__(456),__webpack_require__(457),__webpack_require__(458),__webpack_require__(459),__webpack_require__(460),__webpack_require__(461),__webpack_require__(462),__webpack_require__(463),__webpack_require__(464),__webpack_require__(98),__webpack_require__(58),__webpack_require__(68),__webpack_require__(33),__webpack_require__(74),__webpack_require__(133),__webpack_require__(13),__webpack_require__(9),__webpack_require__(301),__webpack_require__(61),__webpack_require__(31),__webpack_require__(28),__webpack_require__(3),__webpack_require__(41);var ObservedElementAccesibilities={Any:0,Accessible:1,Focusable:2},RestoreFocusOrders={History:0,DeloserDefault:1,RootDefault:2,DeloserFirst:3,RootFirst:4},Visibilities={Invisible:0,PartiallyVisible:1,Visible:2},MoverDirections={Both:0,Vertical:1,Horizontal:2,Grid:3},GroupperTabbabilities={Unlimited:0,Limited:1,LimitedTrapFocus:2},Types=Object.freeze({__proto__:null,TabsterAttributeName:"data-tabster",TabsterDummyInputAttributeName:"data-tabster-dummy",DeloserEventName:"tabster:deloser",ModalizerEventName:"tabster:modalizer",MoverEventName:"tabster:mover",ObservedElementAccesibilities:ObservedElementAccesibilities,RestoreFocusOrders:RestoreFocusOrders,Visibilities:Visibilities,MoverDirections:MoverDirections,GroupperTabbabilities:GroupperTabbabilities});"undefined"!=typeof DOMRect&&DOMRect;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),!1}catch(e){!0}"undefined"!=typeof document&&("onfullscreenchange"in document?"fullscreenchange":"onwebkitfullscreenchange"in document?"webkitfullscreenchange":"onmozfullscreenchange"in document?"mozfullscreenchange":"onmsfullscreenchange"in document&&"msfullscreenchange");function getTabsterAttribute(props,plain){var _a,attr=JSON.stringify(props);return!0===plain?attr:((_a={})["data-tabster"]=attr,_a)}}).call(this,__webpack_require__(135))},4:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(process){__webpack_require__.d(__webpack_exports__,"m",(function(){return getInstanceContext})),__webpack_require__.d(__webpack_exports__,"i",(function(){return disposeInstanceContext})),__webpack_require__.d(__webpack_exports__,"h",(function(){return createWeakMap})),__webpack_require__.d(__webpack_exports__,"d",(function(){return WeakHTMLElement})),__webpack_require__.d(__webpack_exports__,"e",(function(){return cleanupFakeWeakRefs})),__webpack_require__.d(__webpack_exports__,"w",(function(){return startFakeWeakRefsCleanup})),__webpack_require__.d(__webpack_exports__,"x",(function(){return stopFakeWeakRefsCleanupAndClearStorage})),__webpack_require__.d(__webpack_exports__,"g",(function(){return createElementTreeWalker})),__webpack_require__.d(__webpack_exports__,"k",(function(){return getBoundingRect})),__webpack_require__.d(__webpack_exports__,"r",(function(){return isElementVerticallyVisibleInContainer})),__webpack_require__.d(__webpack_exports__,"s",(function(){return isElementVisibleInContainer})),__webpack_require__.d(__webpack_exports__,"u",(function(){return scrollIntoView})),__webpack_require__.d(__webpack_exports__,"v",(function(){return shouldIgnoreFocus})),__webpack_require__.d(__webpack_exports__,"p",(function(){return getUId})),__webpack_require__.d(__webpack_exports__,"l",(function(){return getElementUId})),__webpack_require__.d(__webpack_exports__,"q",(function(){return getWindowUId})),__webpack_require__.d(__webpack_exports__,"f",(function(){return clearElementCache})),__webpack_require__.d(__webpack_exports__,"j",(function(){return documentContains})),__webpack_require__.d(__webpack_exports__,"t",(function(){return matchesSelector})),__webpack_require__.d(__webpack_exports__,"o",(function(){return getPromise})),__webpack_require__.d(__webpack_exports__,"c",(function(){return TabsterPart})),__webpack_require__.d(__webpack_exports__,"a",(function(){return DummyInput})),__webpack_require__.d(__webpack_exports__,"b",(function(){return DummyInputManager})),__webpack_require__.d(__webpack_exports__,"n",(function(){return getLastChild})),__webpack_require__.d(__webpack_exports__,"y",(function(){return triggerEvent}));__webpack_require__(211),__webpack_require__(10),__webpack_require__(15),__webpack_require__(14),__webpack_require__(17),__webpack_require__(48),__webpack_require__(22),__webpack_require__(437),__webpack_require__(442),__webpack_require__(443),__webpack_require__(444),__webpack_require__(445),__webpack_require__(446),__webpack_require__(447),__webpack_require__(448),__webpack_require__(449),__webpack_require__(450),__webpack_require__(451),__webpack_require__(452),__webpack_require__(453),__webpack_require__(454),__webpack_require__(455),__webpack_require__(456),__webpack_require__(457),__webpack_require__(458),__webpack_require__(459),__webpack_require__(460),__webpack_require__(461),__webpack_require__(462),__webpack_require__(463),__webpack_require__(464),__webpack_require__(98),__webpack_require__(58),__webpack_require__(18);var _isBrokenIE11,_Types__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(20);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _DOMRect="undefined"!=typeof DOMRect?DOMRect:function(){return function _class2(x,y,width,height){_classCallCheck(this,_class2),this.bottom=void 0,this.left=void 0,this.right=void 0,this.top=void 0,this.left=x||0,this.top=y||0,this.right=(x||0)+(width||0),this.bottom=(y||0)+(height||0)}}(),_uidCounter=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),_isBrokenIE11=!1}catch(e){_isBrokenIE11=!0}function getInstanceContext(getWindow){var win=getWindow(),ctx=win.__tabsterInstanceContext;return ctx||(ctx={elementByUId:{},basics:{Promise:win.Promise||void 0,WeakRef:win.WeakRef||void 0},containerBoundingRectCache:{},lastContainerBoundingRectCacheId:0,fakeWeakRefs:[],fakeWeakRefsStarted:!1},win.__tabsterInstanceContext=ctx),ctx}function disposeInstanceContext(win){var ctx=win.__tabsterInstanceContext;ctx&&(ctx.elementByUId={},delete ctx.WeakRef,ctx.containerBoundingRectCache={},ctx.containerBoundingRectCacheTimer&&win.clearTimeout(ctx.containerBoundingRectCacheTimer),ctx.fakeWeakRefsTimer&&win.clearTimeout(ctx.fakeWeakRefsTimer),ctx.fakeWeakRefs=[],delete win.__tabsterInstanceContext)}function createWeakMap(win){var ctx=win.__tabsterInstanceContext;return new((null==ctx?void 0:ctx.basics.WeakMap)||WeakMap)}var FakeWeakRef=function(){function FakeWeakRef(target){_classCallCheck(this,FakeWeakRef),this._target=void 0,this._target=target}return _createClass(FakeWeakRef,[{key:"deref",value:function deref(){return this._target}}],[{key:"cleanup",value:function cleanup(fwr,forceRemove){return!fwr._target||!(!forceRemove&&documentContains(fwr._target.ownerDocument,fwr._target))&&(delete fwr._target,!0)}}]),FakeWeakRef}(),WeakHTMLElement=function(){function WeakHTMLElement(getWindow,element,data){_classCallCheck(this,WeakHTMLElement),this._ref=void 0,this._data=void 0;var ref,context=getInstanceContext(getWindow);context.WeakRef?ref=new context.WeakRef(element):(ref=new FakeWeakRef(element),context.fakeWeakRefs.push(ref)),this._ref=ref,this._data=data}return _createClass(WeakHTMLElement,[{key:"get",value:function get(){var element,ref=this._ref;return ref&&((element=ref.deref())||delete this._ref),element}},{key:"getData",value:function getData(){return this._data}}]),WeakHTMLElement}();function cleanupFakeWeakRefs(getWindow,forceRemove){var context=getInstanceContext(getWindow);context.fakeWeakRefs=context.fakeWeakRefs.filter((function(e){return!FakeWeakRef.cleanup(e,forceRemove)}))}function startFakeWeakRefsCleanup(getWindow){var context=getInstanceContext(getWindow);context.fakeWeakRefsStarted||(context.fakeWeakRefsStarted=!0,context.WeakRef=function getWeakRef(context){return context.basics.WeakRef}(context)),context.fakeWeakRefsTimer||(context.fakeWeakRefsTimer=getWindow().setTimeout((function(){context.fakeWeakRefsTimer=void 0,cleanupFakeWeakRefs(getWindow),startFakeWeakRefsCleanup(getWindow)}),12e4))}function stopFakeWeakRefsCleanupAndClearStorage(getWindow){var context=getInstanceContext(getWindow);context.fakeWeakRefsStarted=!1,context.fakeWeakRefsTimer&&(getWindow().clearTimeout(context.fakeWeakRefsTimer),context.fakeWeakRefsTimer=void 0,context.fakeWeakRefs=[])}function createElementTreeWalker(doc,root,acceptNode){if(root.nodeType===Node.ELEMENT_NODE){var filter=_isBrokenIE11?acceptNode:{acceptNode:acceptNode};return doc.createTreeWalker(root,NodeFilter.SHOW_ELEMENT,filter,!1)}}function getBoundingRect(getWindow,element){var cacheId=element.__tabsterCacheId,context=getInstanceContext(getWindow),cached=cacheId?context.containerBoundingRectCache[cacheId]:void 0;if(cached)return cached.rect;var scrollingElement=element.ownerDocument&&element.ownerDocument.documentElement;if(!scrollingElement)return new _DOMRect;var left=0,top=0,right=scrollingElement.clientWidth,bottom=scrollingElement.clientHeight;if(element!==scrollingElement){var r=element.getBoundingClientRect();left=Math.max(left,r.left),top=Math.max(top,r.top),right=Math.min(right,r.right),bottom=Math.min(bottom,r.bottom)}var rect=new _DOMRect(left<right?left:-1,top<bottom?top:-1,left<right?right-left:0,top<bottom?bottom-top:0);return cacheId||(cacheId="r-"+ ++context.lastContainerBoundingRectCacheId,element.__tabsterCacheId=cacheId),context.containerBoundingRectCache[cacheId]={rect:rect,element:element},context.containerBoundingRectCacheTimer||(context.containerBoundingRectCacheTimer=window.setTimeout((function(){context.containerBoundingRectCacheTimer=void 0;for(var _i=0,_Object$keys=Object.keys(context.containerBoundingRectCache);_i<_Object$keys.length;_i++){var cId=_Object$keys[_i];delete context.containerBoundingRectCache[cId].element.__tabsterCacheId}context.containerBoundingRectCache={}}),50)),rect}function isElementVerticallyVisibleInContainer(getWindow,element){var container=getScrollableContainer(element);if(container){var containerRect=getBoundingRect(getWindow,container),elementRect=element.getBoundingClientRect();return elementRect.top>=containerRect.top&&elementRect.bottom<=containerRect.bottom}return!1}function isElementVisibleInContainer(getWindow,element){var gap=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,container=getScrollableContainer(element);if(container){var containerRect=getBoundingRect(getWindow,container),elementRect=element.getBoundingClientRect();return elementRect.left>containerRect.right||elementRect.top>containerRect.bottom||elementRect.bottom<containerRect.top||elementRect.right<containerRect.left?_Types__WEBPACK_IMPORTED_MODULE_34__.Visibilities.Invisible:elementRect.top+gap>=containerRect.top&&elementRect.top<=containerRect.bottom&&elementRect.bottom>=containerRect.top&&elementRect.bottom-gap<=containerRect.bottom&&elementRect.left+gap>=containerRect.left&&elementRect.left<=containerRect.right&&elementRect.right>=containerRect.left&&elementRect.right-gap<=containerRect.right?_Types__WEBPACK_IMPORTED_MODULE_34__.Visibilities.Visible:_Types__WEBPACK_IMPORTED_MODULE_34__.Visibilities.PartiallyVisible}return _Types__WEBPACK_IMPORTED_MODULE_34__.Visibilities.Invisible}function scrollIntoView(getWindow,element,alignToTop){var container=getScrollableContainer(element);if(container){var containerRect=getBoundingRect(getWindow,container),elementRect=element.getBoundingClientRect();container.scrollTop+=alignToTop?elementRect.top-containerRect.top:elementRect.bottom-containerRect.bottom}}function getScrollableContainer(element){var doc=element.ownerDocument;if(doc){for(var el=element.parentElement;el;el=el.parentElement)if(el.scrollWidth>el.clientWidth||el.scrollHeight>el.clientHeight)return el;return doc.documentElement}return null}function shouldIgnoreFocus(element){return!!element.__shouldIgnoreFocus}function getUId(wnd){var rnd=new Uint32Array(4);if(wnd.crypto&&wnd.crypto.getRandomValues)wnd.crypto.getRandomValues(rnd);else if(wnd.msCrypto&&wnd.msCrypto.getRandomValues)wnd.msCrypto.getRandomValues(rnd);else for(var i=0;i<rnd.length;i++)rnd[i]=4294967295*Math.random();for(var srnd=[],_i2=0;_i2<rnd.length;_i2++)srnd.push(rnd[_i2].toString(36));return srnd.push("|"),srnd.push((++_uidCounter).toString(36)),srnd.push("|"),srnd.push(Date.now().toString(36)),srnd.join("")}function getElementUId(getWindow,element){var context=getInstanceContext(getWindow),uid=element.__tabsterElementUID;return uid||(uid=element.__tabsterElementUID=getUId(getWindow())),!context.elementByUId[uid]&&documentContains(element.ownerDocument,element)&&(context.elementByUId[uid]=new WeakHTMLElement(getWindow,element)),uid}function getWindowUId(win){var uid=win.__tabsterCrossOriginWindowUID;return uid||(uid=win.__tabsterCrossOriginWindowUID=getUId(win)),uid}function clearElementCache(getWindow,parent){for(var context=getInstanceContext(getWindow),_i3=0,_Object$keys2=Object.keys(context.elementByUId);_i3<_Object$keys2.length;_i3++){var key=_Object$keys2[_i3],wel=context.elementByUId[key],el=wel&&wel.get();el&&parent&&!parent.contains(el)||delete context.elementByUId[key]}}function documentContains(doc,element){var _doc$body;return!(null==doc||null===(_doc$body=doc.body)||void 0===_doc$body||!_doc$body.contains(element))}function matchesSelector(element,selector){var matches=element.matches||element.matchesSelector||element.msMatchesSelector||element.webkitMatchesSelector;return matches&&matches.call(element,selector)}function getPromise(getWindow){var context=getInstanceContext(getWindow);if(context.basics.Promise)return context.basics.Promise;throw new Error("No Promise defined.")}var _lastTabsterPartId=0,TabsterPart=function(){function TabsterPart(tabster,element,props){_classCallCheck(this,TabsterPart),this._tabster=void 0,this._element=void 0,this._props=void 0,this.id=void 0;var getWindow=tabster.getWindow;this._tabster=tabster,this._element=new WeakHTMLElement(getWindow,element),this._props=Object.assign({},props),this.id="i"+ ++_lastTabsterPartId}return _createClass(TabsterPart,[{key:"getElement",value:function getElement(){return this._element.get()}},{key:"getProps",value:function getProps(){return this._props}},{key:"setProps",value:function setProps(props){this._props=Object.assign({},props)}}]),TabsterPart}(),DummyInput=function(){function DummyInput(getWindow,props){var _props$isPhantom,_this=this;_classCallCheck(this,DummyInput),this._isPhantom=void 0,this.input=void 0,this.shouldMoveOut=void 0,this.isFirst=void 0,this.onFocusIn=void 0,this.onFocusOut=void 0,this._focusIn=function(){_this.onFocusIn&&_this.input&&_this.onFocusIn(_this)},this._focusOut=function(){_this.shouldMoveOut=!1,_this.onFocusOut&&_this.input&&_this.onFocusOut(_this),_this._isPhantom&&_this.dispose()};var input=getWindow().document.createElement("div");input.tabIndex=0,input.setAttribute("role","none"),input.setAttribute(_Types__WEBPACK_IMPORTED_MODULE_34__.TabsterDummyInputAttributeName,""),input.setAttribute("aria-hidden","true");var style=input.style;style.position="fixed",style.width=style.height="1px",style.left=style.top="-100500px",style.opacity="0",style.zIndex="-1",function makeFocusIgnored(element){element.__shouldIgnoreFocus=!0}(input),this.input=input,this.isFirst=props.isFirst,this._isPhantom=null!==(_props$isPhantom=props.isPhantom)&&void 0!==_props$isPhantom&&_props$isPhantom,input.addEventListener("focusin",this._focusIn),input.addEventListener("focusout",this._focusOut)}return _createClass(DummyInput,[{key:"dispose",value:function dispose(){var _input$parentElement,input=this.input;input&&(delete this.onFocusIn,delete this.onFocusOut,delete this.input,input.removeEventListener("focusin",this._focusIn),input.removeEventListener("focusout",this._focusOut),null===(_input$parentElement=input.parentElement)||void 0===_input$parentElement||_input$parentElement.removeChild(input))}}]),DummyInput}(),DummyInputManager=function(){function DummyInputManager(tabster,element){var _this2=this;_classCallCheck(this,DummyInputManager),this._unobserve=void 0,this._element=void 0,this.firstDummy=void 0,this.lastDummy=void 0,this.moveOutWithDefaultAction=function(backwards){var first=_this2.firstDummy,last=_this2.lastDummy;null!=first&&first.input&&null!=last&&last.input&&(backwards?(first.shouldMoveOut=!0,first.input.focus()):(last.shouldMoveOut=!0,last.input.focus()))};var win=tabster.getWindow;this.firstDummy=new DummyInput(win,{isFirst:!0}),this.lastDummy=new DummyInput(win,{isFirst:!1}),this._element=element,this._addDummyInputs(),this._observeMutations()}return _createClass(DummyInputManager,[{key:"dispose",value:function dispose(){var _this$_unobserve;this.firstDummy.dispose(),this.lastDummy.dispose(),null===(_this$_unobserve=this._unobserve)||void 0===_this$_unobserve||_this$_unobserve.call(this)}},{key:"_addDummyInputs",value:function _addDummyInputs(){var _this$firstDummy,_this$lastDummy,element=this._element.get(),dif=null===(_this$firstDummy=this.firstDummy)||void 0===_this$firstDummy?void 0:_this$firstDummy.input,dil=null===(_this$lastDummy=this.lastDummy)||void 0===_this$lastDummy?void 0:_this$lastDummy.input;if(element&&dif&&dil){element.lastElementChild!==dil&&element.appendChild(dil);var firstElementChild=element.firstElementChild;firstElementChild&&firstElementChild!==dif&&element.insertBefore(dif,firstElementChild)}}},{key:"_observeMutations",value:function _observeMutations(){var _this3=this;if(!this._unobserve){var observer=new MutationObserver((function(){_this3._addDummyInputs()})),element=this._element.get();element&&(observer.observe(element,{childList:!0}),this._unobserve=function(){observer.disconnect()})}}}]),DummyInputManager}();function getLastChild(container){for(var lastChild=null,i=container.lastElementChild;i;i=i.lastElementChild)lastChild=i;return lastChild}function triggerEvent(target,name,details){var event=document.createEvent("HTMLEvents");return event.initEvent(name,!0,!0),event.details=details,target.dispatchEvent(event),!event.defaultPrevented}}).call(this,__webpack_require__(135))},506:function(module,exports,__webpack_require__){__webpack_require__(507),__webpack_require__(662),__webpack_require__(663),__webpack_require__(867),__webpack_require__(872),__webpack_require__(873),__webpack_require__(874),__webpack_require__(871),__webpack_require__(868),__webpack_require__(875),__webpack_require__(869),__webpack_require__(870),__webpack_require__(876),module.exports=__webpack_require__(857)},573:function(module,exports){},663:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(355)},857:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(355).configure)([__webpack_require__(858),__webpack_require__(859)],module,!1)}).call(this,__webpack_require__(209)(module))},858:function(module,exports){function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,module.exports=webpackEmptyContext,webpackEmptyContext.id=858},859:function(module,exports,__webpack_require__){var map={"./Groupper/Groupper.stories.ts":877,"./Modalizer/Modalizer.stories.ts":878,"./Mover/Mover.stories.ts":879,"./TestContainer.stories.tsx":866};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=859},860:function(module,exports,__webpack_require__){var api=__webpack_require__(302),content=__webpack_require__(861);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},861:function(module,exports,__webpack_require__){(exports=__webpack_require__(303)(!1)).push([module.i,".item {\n    width: 500px;\n    border: 2px dashed red;\n    padding: 4px;\n}\n",""]),module.exports=exports},862:function(module,exports,__webpack_require__){var api=__webpack_require__(302),content=__webpack_require__(863);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},863:function(module,exports,__webpack_require__){(exports=__webpack_require__(303)(!1)).push([module.i,".lightbox {\n    position: fixed;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.2);\n}\n\n.hidden {\n    display: none;\n}\n\n.modal {\n    position: fixed;\n    left: 20%;\n    top: 20%;\n    right: 20%;\n    bottom: 20%;\n    background: #fff;\n    border: 1px solid rgba(0, 0, 0, 0.4);\n    padding: 20px;\n    display: flex;\n    flex-direction: column;\n}\n\n.modal-body {\n    display: flex;\n    flex-direction: column;\n}\n\n.button-group {\n    display: flex;\n    margin-left: auto;\n    margin-top: auto;\n    gap: 10px;\n}\n",""]),module.exports=exports},864:function(module,exports,__webpack_require__){var api=__webpack_require__(302),content=__webpack_require__(865);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},865:function(module,exports,__webpack_require__){(exports=__webpack_require__(303)(!1)).push([module.i,".mover-wrapper {\n    display: flex;\n    flex-direction: column;\n    width: 200px;\n}\n\n.mover-item {\n    margin: 0;\n}\n",""]),module.exports=exports},866:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TestContainer",(function(){return TestContainer}));__webpack_require__(18);__webpack_exports__.default={title:"TestContainer"};var TestContainer=function TestContainer(){return"<div />"};TestContainer.parameters=Object.assign({storySource:{source:'() => "<div />"'}},TestContainer.parameters)},876:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var preview_namespaceObject={};__webpack_require__.r(preview_namespaceObject),__webpack_require__.d(preview_namespaceObject,"parameters",(function(){return parameters})),__webpack_require__.d(preview_namespaceObject,"decorators",(function(){return decorators}));__webpack_require__(22),__webpack_require__(7),__webpack_require__(48),__webpack_require__(216),__webpack_require__(43),__webpack_require__(842);var client_api=__webpack_require__(887),esm=__webpack_require__(6),Tabster=__webpack_require__(886),parameters={actions:{argTypesRegex:"^on[A-Z].*"},controls:{matchers:{color:/(background|color)$/i,date:/Date$/}}},decorators=[function(Story){if(!Object(Tabster.c)(window)){var controlTab=!Object({NODE_ENV:"production",NODE_PATH:[],STORYBOOK:"true",PUBLIC_URL:"."}).STORYBOOK_UNCONTROLLED,tabster=Object(Tabster.b)(window,{autoRoot:{},controlTab:controlTab});console.log("created tabster","as "+(controlTab?"controlled":"uncontrolled")),Object(Tabster.f)(tabster),console.log("created modalizer"),Object(Tabster.d)(tabster),console.log("created deloser"),Object(Tabster.i)(tabster),console.log("created outline"),Object(Tabster.g)(tabster),console.log("created mover"),Object(Tabster.e)(tabster),console.log("created groupper"),Object(Tabster.h)(tabster),console.log("created observed")}return Story()}];function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.keys(preview_namespaceObject).forEach((function(key){var value=preview_namespaceObject[key];switch(key){case"args":case"argTypes":return esm.a.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(value));case"decorators":return value.forEach((function(decorator){return Object(client_api.c)(decorator,!1)}));case"loaders":return value.forEach((function(loader){return Object(client_api.d)(loader,!1)}));case"parameters":return Object(client_api.e)(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},value),!1);case"argTypesEnhancers":return value.forEach((function(enhancer){return Object(client_api.a)(enhancer)}));case"argsEnhancers":return value.forEach((function(enhancer){return Object(client_api.b)(enhancer)}));case"render":return Object(client_api.g)(value);case"globals":case"globalTypes":var v={};return v[key]=value,Object(client_api.e)(v,!1);default:return console.log(key+" was not supported :( !")}}))},877:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"WithFocusTrap",(function(){return WithFocusTrap})),__webpack_require__.d(__webpack_exports__,"OnlyTabOut",(function(){return OnlyTabOut})),__webpack_require__.d(__webpack_exports__,"TabInAndOut",(function(){return TabInAndOut}));__webpack_require__(18);var Tabster=__webpack_require__(886),Groupper_stories_FocusableContainer=(__webpack_require__(860),__webpack_exports__.default={title:"Groupper",argTypes:{tabbability:{control:"select",options:Tabster.a.GroupperTabbabilities}}},function FocusableContainer(args){return function createFocusableContainer(props){var tabbability=props.tabbability,wrapper=document.createElement("div");wrapper.tabIndex=0,wrapper.classList.add("item");var attr=Object(Tabster.j)({groupper:{tabbability:tabbability}},!0);return wrapper.setAttribute(Tabster.a.TabsterAttributeName,attr),wrapper.innerHTML="\n    <button>Focusable button</button>\n    <button>Focusable button</button>\n  ",wrapper}(args)}),WithFocusTrap=Groupper_stories_FocusableContainer.bind({});WithFocusTrap.args={tabbability:Tabster.a.GroupperTabbabilities.LimitedTrapFocus};var OnlyTabOut=Groupper_stories_FocusableContainer.bind({});OnlyTabOut.args={tabbability:Tabster.a.GroupperTabbabilities.Limited};var TabInAndOut=Groupper_stories_FocusableContainer.bind({});TabInAndOut.args={tabbability:Tabster.a.GroupperTabbabilities.Unlimited},WithFocusTrap.parameters=Object.assign({storySource:{source:"(args) => {\n    return createFocusableContainer(args);\n}"}},WithFocusTrap.parameters),OnlyTabOut.parameters=Object.assign({storySource:{source:"(args) => {\n    return createFocusableContainer(args);\n}"}},OnlyTabOut.parameters),TabInAndOut.parameters=Object.assign({storySource:{source:"(args) => {\n    return createFocusableContainer(args);\n}"}},TabInAndOut.parameters)},878:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Basic",(function(){return Basic}));__webpack_require__(18),__webpack_require__(862);var Tabster=__webpack_require__(886),ModalDialog_createModalDialog=function createModalDialog(props){var _dialog$querySelector,_dialog$querySelector2,_props$id=props.id,id=void 0===_props$id?"modalizer":_props$id,isAlwaysAccessible=props.isAlwaysAccessible,isNoFocusDefault=props.isNoFocusDefault,isNoFocusFirst=props.isNoFocusFirst,isOthersAccessible=props.isOthersAccessible,tabster=Object(Tabster.c)(window),dialog=document.createElement("div");dialog.classList.add("lightbox"),dialog.classList.add("hidden"),dialog.innerHTML='\n      <div aria-label="Modal" role="region" class="modal">\n        <h3>Modal dialog</h3>\n        <div class="modal-body">\n          This is a modal dialog powered by Tabster\n\n          <button>Focusable item</button>\n          <button>Focusable item</button>\n          <button>Focusable item</button>\n        </div>\n      <div class="button-group" />\n    ';var closeDialog=function closeDialog(){return dialog.classList.add("hidden")},rootBtn=document.createElement("button");rootBtn.innerHTML="Open modal dialog",rootBtn.addEventListener("click",(function(){!function openDialog(){dialog.classList.remove("hidden");var firstFocusable=null==tabster?void 0:tabster.focusable.findFirst({container:dialog});null==firstFocusable||firstFocusable.focus()}()}));var closeButton=document.createElement("button");closeButton.innerHTML="Close dialog",closeButton.addEventListener("click",(function(){closeDialog()}));var dismissButton=closeButton.cloneNode();dismissButton.innerHTML="Dismiss dialog",dismissButton.addEventListener("click",(function(){closeDialog()}));var isDialogOpen=function isDialogOpen(){return!dialog.classList.contains("hidden")};document.addEventListener("click",(function(e){var _dialog$firstElementC;!isDialogOpen()||!e.target||null!==(_dialog$firstElementC=dialog.firstElementChild)&&void 0!==_dialog$firstElementC&&_dialog$firstElementC.contains(e.target)||rootBtn.contains(e.target)||closeDialog()})),document.addEventListener("keydown",(function(e){isDialogOpen()&&"Escape"===e.key&&closeDialog()}));var wrapper=document.createElement("div");wrapper.appendChild(rootBtn),wrapper.appendChild(dialog),null===(_dialog$querySelector=dialog.querySelector(".button-group"))||void 0===_dialog$querySelector||_dialog$querySelector.appendChild(closeButton),null===(_dialog$querySelector2=dialog.querySelector(".button-group"))||void 0===_dialog$querySelector2||_dialog$querySelector2.appendChild(dismissButton);var attr=Object(Tabster.j)({modalizer:{id:id,isAlwaysAccessible:isAlwaysAccessible,isNoFocusDefault:isNoFocusDefault,isNoFocusFirst:isNoFocusFirst,isOthersAccessible:isOthersAccessible}},!0);return dialog.setAttribute(Tabster.a.TabsterAttributeName,attr),wrapper},Basic=(__webpack_exports__.default={title:"Modalizer",argTypes:{isAlwaysAccessible:{control:"boolean"},isNoFocusDefault:{control:"boolean"},isNoFocusFirst:{control:"boolean"},isOthersAccessible:{control:"boolean"}}},function SimpleFocusableCollection(args){return ModalDialog_createModalDialog(args)}.bind({}));Basic.parameters=Object.assign({storySource:{source:"(args) => {\n    return createModalDialog(args);\n}"}},Basic.parameters)},879:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"HorizontalAndVertical",(function(){return HorizontalAndVertical})),__webpack_require__.d(__webpack_exports__,"Circular",(function(){return Circular})),__webpack_require__.d(__webpack_exports__,"VerticalOnly",(function(){return VerticalOnly})),__webpack_require__.d(__webpack_exports__,"HorizontalOnly",(function(){return HorizontalOnly})),__webpack_require__.d(__webpack_exports__,"Tabbable",(function(){return Tabbable}));__webpack_require__(18);var Tabster=__webpack_require__(886),tabster_esm=(__webpack_require__(864),__webpack_require__(309)),Mover_stories_SimpleFocusableCollection=(__webpack_exports__.default={title:"Mover",argTypes:{cyclic:{control:"boolean"},direction:{control:"select",options:Tabster.a.MoverDirections},memorizeCurrent:{control:"boolean"},tabbable:{control:"boolean"},trackState:{control:"boolean"},visibilityAware:{control:"boolean"}}},function SimpleFocusableCollection(args){return function createBasicMover(_ref){var cyclic=_ref.cyclic,direction=_ref.direction,disableHomeEndKeys=_ref.disableHomeEndKeys,memorizeCurrent=_ref.memorizeCurrent,tabbable=_ref.tabbable,trackState=_ref.trackState,visibilityAware=_ref.visibilityAware;console.log(direction);var wrapper=document.createElement("div");wrapper.classList.add("mover-wrapper"),wrapper.innerHTML='\n    <button class="mover-item">Mover Item</button>\n    <button class="mover-item">Mover Item</button>\n    <button class="mover-item">Mover Item</button>\n    <button class="mover-item">Mover Item</button>\n  ';var attr=Object(tabster_esm.b)({mover:{cyclic:cyclic,direction:direction,disableHomeEndKeys:disableHomeEndKeys,memorizeCurrent:memorizeCurrent,tabbable:tabbable,trackState:trackState,visibilityAware:visibilityAware}},!0);return wrapper.setAttribute(tabster_esm.a.TabsterAttributeName,attr),wrapper}(args)}),HorizontalAndVertical=Mover_stories_SimpleFocusableCollection.bind({}),Circular=Mover_stories_SimpleFocusableCollection.bind({});Circular.args={cyclic:!0};var VerticalOnly=Mover_stories_SimpleFocusableCollection.bind({});VerticalOnly.args={direction:Tabster.a.MoverDirections.Vertical};var HorizontalOnly=Mover_stories_SimpleFocusableCollection.bind({});HorizontalOnly.args={direction:Tabster.a.MoverDirections.Horizontal};var Tabbable=Mover_stories_SimpleFocusableCollection.bind({});Tabbable.args={tabbable:!0},HorizontalAndVertical.parameters=Object.assign({storySource:{source:"(args) => {\n    return createBasicMover(args);\n}"}},HorizontalAndVertical.parameters),Circular.parameters=Object.assign({storySource:{source:"(args) => {\n    return createBasicMover(args);\n}"}},Circular.parameters),VerticalOnly.parameters=Object.assign({storySource:{source:"(args) => {\n    return createBasicMover(args);\n}"}},VerticalOnly.parameters),HorizontalOnly.parameters=Object.assign({storySource:{source:"(args) => {\n    return createBasicMover(args);\n}"}},HorizontalOnly.parameters),Tabbable.parameters=Object.assign({storySource:{source:"(args) => {\n    return createBasicMover(args);\n}"}},Tabbable.parameters)},886:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Types})),__webpack_require__.d(__webpack_exports__,"b",(function(){return createTabster})),__webpack_require__.d(__webpack_exports__,"e",(function(){return getGroupper})),__webpack_require__.d(__webpack_exports__,"g",(function(){return getMover})),__webpack_require__.d(__webpack_exports__,"i",(function(){return getOutline})),__webpack_require__.d(__webpack_exports__,"d",(function(){return Tabster_getDeloser})),__webpack_require__.d(__webpack_exports__,"f",(function(){return getModalizer})),__webpack_require__.d(__webpack_exports__,"h",(function(){return getObservedElement})),__webpack_require__.d(__webpack_exports__,"j",(function(){return getTabsterAttribute})),__webpack_require__.d(__webpack_exports__,"c",(function(){return getCurrentTabster}));__webpack_require__(211),__webpack_require__(10),__webpack_require__(15),__webpack_require__(14),__webpack_require__(17),__webpack_require__(22),__webpack_require__(13),__webpack_require__(9),__webpack_require__(29),__webpack_require__(7),__webpack_require__(12),__webpack_require__(21),__webpack_require__(61),__webpack_require__(18),__webpack_require__(53),__webpack_require__(146),__webpack_require__(28),__webpack_require__(301),__webpack_require__(48),__webpack_require__(31),__webpack_require__(57),__webpack_require__(300),__webpack_require__(216),__webpack_require__(43),__webpack_require__(68),__webpack_require__(33),__webpack_require__(74),__webpack_require__(133),__webpack_require__(58);var Types=__webpack_require__(20);function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function getTabsterOnElement(tabster,element){var _storageEntry;return null===(_storageEntry=tabster.storageEntry(element))||void 0===_storageEntry?void 0:_storageEntry.tabster}function Instance_updateTabsterByAttribute(tabster,element,dispose){var _entry$attr2,_newAttr,newAttr,newAttrValue=dispose||tabster._noop?void 0:element.getAttribute(Types.TabsterAttributeName),tabsteri=tabster,entry=tabsteri.storageEntry(element);if(newAttrValue){var _entry,_entry$attr;if(newAttrValue===(null===(_entry=entry)||void 0===_entry||null===(_entry$attr=_entry.attr)||void 0===_entry$attr?void 0:_entry$attr.string))return;try{var newValue=JSON.parse(newAttrValue);if("object"!=typeof newValue)throw new Error("Value is not a JSON object, got '"+newAttrValue+"'.");newAttr={string:newAttrValue,object:newValue}}catch(e){0}}else if(!entry)return;entry||(entry=tabster.storageEntry(element,!0)),entry.tabster||(entry.tabster={});var _step,tabsterOnElement=entry.tabster||{},oldTabsterProps=(null===(_entry$attr2=entry.attr)||void 0===_entry$attr2?void 0:_entry$attr2.object)||{},newTabsterProps=(null===(_newAttr=newAttr)||void 0===_newAttr?void 0:_newAttr.object)||{},_iterator=_createForOfIteratorHelper(Object.keys(oldTabsterProps));try{for(_iterator.s();!(_step=_iterator.n()).done;){var key=_step.value;if(!newTabsterProps[key]){if("root"===key){var root=tabsterOnElement[key];root&&tabsteri.updateRoot(root,!0)}else if("modalizer"===key){var modalizer=tabsterOnElement.modalizer;tabsteri.updateModalizer&&modalizer&&tabsteri.updateModalizer(modalizer,!0)}switch(key){case"deloser":case"root":case"groupper":case"modalizer":case"mover":var part=tabsterOnElement[key];part&&(part.dispose(),delete tabsterOnElement[key]);break;case"observed":delete tabsterOnElement[key],tabsteri.updateObserved&&tabsteri.updateObserved(element);break;case"focusable":case"outline":case"uncontrolled":delete tabsterOnElement[key]}}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=_createForOfIteratorHelper(Object.keys(newTabsterProps));try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _key=_step2.value;switch(_key){case"deloser":tabsterOnElement.deloser?tabsterOnElement.deloser.setProps(newTabsterProps.deloser):tabsteri.createDeloser&&(tabsterOnElement.deloser=tabsteri.createDeloser(tabsteri,element,newTabsterProps.deloser));break;case"root":tabsterOnElement.root?tabsterOnElement.root.setProps(newTabsterProps.root):tabsterOnElement.root=tabsteri.createRoot(tabsteri,element,newTabsterProps.root),tabsteri.updateRoot(tabsterOnElement.root);break;case"modalizer":tabsterOnElement.modalizer?tabsterOnElement.modalizer.setProps(newTabsterProps.modalizer):tabsteri.createModalizer&&(tabsterOnElement.modalizer=tabsteri.createModalizer(tabsteri,element,newTabsterProps.modalizer));break;case"focusable":tabsterOnElement.focusable=newTabsterProps.focusable;break;case"groupper":tabsterOnElement.groupper?tabsterOnElement.groupper.setProps(newTabsterProps.groupper):tabsteri.createGroupper&&(tabsterOnElement.groupper=tabsteri.createGroupper(tabsteri,element,newTabsterProps.groupper));break;case"mover":tabsterOnElement.mover?tabsterOnElement.mover.setProps(newTabsterProps.mover):tabsteri.createMover&&(tabsterOnElement.mover=tabsteri.createMover(tabsteri,element,newTabsterProps.mover));break;case"observed":tabsteri.updateObserved&&(tabsterOnElement.observed=newTabsterProps.observed,tabsteri.updateObserved(element));break;case"uncontrolled":tabsterOnElement.uncontrolled=newTabsterProps.uncontrolled;break;case"outline":tabsteri.outline&&(tabsterOnElement.outline=newTabsterProps.outline);break;default:console.error("Unknown key '"+_key+"' in data-tabster attribute value.")}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}newAttr?entry.attr=newAttr:(0===Object.keys(tabsterOnElement).length&&(delete entry.tabster,delete entry.attr),tabsteri.storageEntry(element,!1))}var keyborg_esm=__webpack_require__(41);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Subscribable=function(){function Subscribable(){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Subscribable),this._val=void 0,this._callbacks=[]}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(Subscribable,[{key:"dispose",value:function dispose(){this._callbacks=[],delete this._val}},{key:"subscribe",value:function subscribe(callback){this._callbacks.indexOf(callback)<0&&this._callbacks.push(callback)}},{key:"unsubscribe",value:function unsubscribe(callback){var index=this._callbacks.indexOf(callback);index>=0&&this._callbacks.splice(index,1)}},{key:"setVal",value:function setVal(val,details){this._val!==val&&(this._val=val,this._callCallbacks(val,details))}},{key:"getVal",value:function getVal(){return this._val}},{key:"trigger",value:function trigger(val,details){this._callCallbacks(val,details)}},{key:"_callCallbacks",value:function _callCallbacks(val,details){this._callbacks.forEach((function(callback){return callback(val,details)}))}}]),Subscribable}();function KeyboardNavigation_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=_superPropBase(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},_get.apply(this,arguments)}function _superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var KeyboardNavigation_KeyboardNavigationState=function(_Subscribable){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(KeyboardNavigationState,_Subscribable);var _super=_createSuper(KeyboardNavigationState);function KeyboardNavigationState(getWindow){var _this;return function KeyboardNavigation_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,KeyboardNavigationState),(_this=_super.call(this))._keyborg=void 0,_this._onChange=function(isNavigatingWithKeyboard){_this.setVal(isNavigatingWithKeyboard,void 0)},_this._keyborg=Object(keyborg_esm.b)(getWindow()),_this._keyborg.subscribe(_this._onChange),_this}return function KeyboardNavigation_createClass(Constructor,protoProps,staticProps){return protoProps&&KeyboardNavigation_defineProperties(Constructor.prototype,protoProps),staticProps&&KeyboardNavigation_defineProperties(Constructor,staticProps),Constructor}(KeyboardNavigationState,[{key:"dispose",value:function dispose(){_get(_getPrototypeOf(KeyboardNavigationState.prototype),"dispose",this).call(this),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),Object(keyborg_esm.c)(this._keyborg),delete this._keyborg)}},{key:"isNavigatingWithKeyboard",value:function isNavigatingWithKeyboard(){var _this$_keyborg;return!(null===(_this$_keyborg=this._keyborg)||void 0===_this$_keyborg||!_this$_keyborg.isNavigatingWithKeyboard())}}],[{key:"dispose",value:function dispose(instance){instance.dispose()}},{key:"setVal",value:function setVal(instance,val){var _keyborg;null===(_keyborg=instance._keyborg)||void 0===_keyborg||_keyborg.setVal(val)}}]),KeyboardNavigationState}(Subscribable),Utils=__webpack_require__(4);function Root_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Root_createClass(Constructor,protoProps,staticProps){return protoProps&&Root_defineProperties(Constructor.prototype,protoProps),staticProps&&Root_defineProperties(Constructor,staticProps),Constructor}function Root_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Root_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Root_setPrototypeOf(subClass,superClass)}function Root_setPrototypeOf(o,p){return Root_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Root_setPrototypeOf(o,p)}function Root_createSuper(Derived){var hasNativeReflectConstruct=function Root_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Root_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Root_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Root_possibleConstructorReturn(this,result)}}function Root_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Root_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Root_getPrototypeOf(o){return Root_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Root_getPrototypeOf(o)}var Root_RootDummyManager=function(_DummyInputManager){Root_inherits(RootDummyManager,_DummyInputManager);var _super=Root_createSuper(RootDummyManager);function RootDummyManager(tabster,_element,setFocused){var _this;return Root_classCallCheck(this,RootDummyManager),(_this=_super.call(this,tabster,_element))._tabster=void 0,_this._setFocused=void 0,_this.setTabbable=function(tabbable){var tabIndex=tabbable?0:-1;_this.firstDummy.input&&(_this.firstDummy.input.tabIndex=tabIndex),_this.lastDummy.input&&(_this.lastDummy.input.tabIndex=tabIndex)},_this._onDummyInputFocus=function(dummyInput){if(dummyInput.shouldMoveOut)_this._setFocused(!1,!0);else{var _dummyInput$input;KeyboardNavigation_KeyboardNavigationState.setVal(_this._tabster.keyboardNavigation,!0);var element=_this._element.get();if(element)if(_this._setFocused(!0,!0),dummyInput.isFirst?_this._tabster.focusedElement.focusFirst({container:element}):_this._tabster.focusedElement.focusLast({container:element}))return;null===(_dummyInput$input=dummyInput.input)||void 0===_dummyInput$input||_dummyInput$input.blur()}},_this._tabster=tabster,_this._setFocused=setFocused,_this.firstDummy.onFocusIn=_this._onDummyInputFocus,_this.lastDummy.onFocusIn=_this._onDummyInputFocus,_this}return RootDummyManager}(Utils.b),Root_Root=function(_TabsterPart){Root_inherits(Root,_TabsterPart);var _super2=Root_createSuper(Root);function Root(tabster,_element2,props){var _this2;Root_classCallCheck(this,Root),(_this2=_super2.call(this,tabster,_element2,props)).uid=void 0,_this2._dummyManager=void 0,_this2._isFocused=!1,_this2._setFocusedTimer=void 0,_this2._setFocused=function(hasFocused,fromAdjacent){if(_this2._setFocusedTimer&&(_this2._tabster.getWindow().clearTimeout(_this2._setFocusedTimer),delete _this2._setFocusedTimer),_this2._isFocused!==hasFocused){var element=_this2._element.get();element&&(hasFocused?(_this2._isFocused=!0,Object(Utils.y)(_this2._tabster.root.eventTarget,"focus",{element:element,fromAdjacent:fromAdjacent})):_this2._setFocusedTimer=_this2._tabster.getWindow().setTimeout((function(){delete _this2._setFocusedTimer,_this2._isFocused=!1,Object(Utils.y)(_this2._tabster.root.eventTarget,"blur",{element:element,fromAdjacent:fromAdjacent})}),0))}},_this2._onFocus=function(e){var _this2$_dummyManager2;if(e){var _this2$_dummyManager,ctx=Root_RootAPI.getTabsterContext(_this2._tabster,e);if(ctx&&_this2._setFocused(ctx.root.getElement()===_this2._element.get()),!ctx||ctx.uncontrolled)return void(null===(_this2$_dummyManager=_this2._dummyManager)||void 0===_this2$_dummyManager||_this2$_dummyManager.setTabbable(!1))}else _this2._setFocused(!1);null===(_this2$_dummyManager2=_this2._dummyManager)||void 0===_this2$_dummyManager2||_this2$_dummyManager2.setTabbable(!0)};var win=tabster.getWindow;return _this2.uid=Object(Utils.l)(win,_element2),tabster.controlTab&&(_this2._dummyManager=new Root_RootDummyManager(tabster,_this2._element,_this2._setFocused)),tabster.focusedElement.subscribe(_this2._onFocus),_this2._add(),_this2}return Root_createClass(Root,[{key:"dispose",value:function dispose(){var _this$_dummyManager;this._setFocusedTimer&&(this._tabster.getWindow().clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),null===(_this$_dummyManager=this._dummyManager)||void 0===_this$_dummyManager||_this$_dummyManager.dispose(),this._remove()}},{key:"moveOutWithDefaultAction",value:function moveOutWithDefaultAction(backwards){var _this$_dummyManager2;null===(_this$_dummyManager2=this._dummyManager)||void 0===_this$_dummyManager2||_this$_dummyManager2.moveOutWithDefaultAction(backwards)}},{key:"_add",value:function _add(){0}},{key:"_remove",value:function _remove(){0}}]),Root}(Utils.c);var Root_RootAPI=function(){function RootAPI(tabster,autoRoot){var _this3=this;Root_classCallCheck(this,RootAPI),this._tabster=void 0,this._win=void 0,this._initTimer=void 0,this._autoRoot=void 0,this._autoRootInstance=void 0,this.rootById={},this.eventTarget=void 0,this._init=function(){_this3._initTimer=void 0},this._tabster=tabster,this._win=tabster.getWindow,this._initTimer=this._win().setTimeout(this._init,0),this._autoRoot=autoRoot,this.eventTarget=new EventTarget}return Root_createClass(RootAPI,[{key:"dispose",value:function dispose(){var win=this._win();this._autoRootInstance&&(this._autoRootInstance.dispose(),delete this._autoRootInstance,delete this._autoRoot),this._initTimer&&(win.clearTimeout(this._initTimer),this._initTimer=void 0),this.rootById={}}}],[{key:"dispose",value:function dispose(instance){instance.dispose()}},{key:"getRootByUId",value:function getRootByUId(getWindow,id){var tabster=getWindow().__tabsterInstance;return tabster&&tabster.root.rootById[id]}},{key:"getTabsterContext",value:function getTabsterContext(tabster,element){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(element.ownerDocument){for(var root,modalizer,groupper,mover,isGroupperFirst,isRtl,uncontrolled,checkRtl=options.checkRtl,curElement=element;curElement&&(!root||checkRtl);){var tabsterOnElement=getTabsterOnElement(tabster,curElement);if(checkRtl&&void 0===isRtl){var dir=curElement.dir;dir&&(isRtl="rtl"===dir.toLowerCase())}if(tabsterOnElement){tabsterOnElement.uncontrolled&&(uncontrolled=curElement);var curGroupper=tabsterOnElement.groupper,curMover=tabsterOnElement.mover;!groupper&&curGroupper&&(groupper=curGroupper),!mover&&curMover&&(mover=curMover,isGroupperFirst=!!groupper),!modalizer&&tabsterOnElement.modalizer&&(modalizer=tabsterOnElement.modalizer),tabsterOnElement.root&&(root=tabsterOnElement.root),curElement=curElement.parentElement}else curElement=curElement.parentElement}if(!root){var rootAPI=tabster.root,autoRoot=rootAPI._autoRoot;if(autoRoot&&!rootAPI._autoRootInstance){var _element$ownerDocumen,body=null===(_element$ownerDocumen=element.ownerDocument)||void 0===_element$ownerDocumen?void 0:_element$ownerDocumen.body;body&&(rootAPI._autoRootInstance=new Root_Root(rootAPI._tabster,body,autoRoot))}root=rootAPI._autoRootInstance}return root?{root:root,modalizer:modalizer,groupper:groupper,mover:mover,isGroupperFirst:isGroupperFirst,isRtl:checkRtl?!!isRtl:void 0,uncontrolled:uncontrolled}:void 0}}},{key:"onRoot",value:function onRoot(instance,root,removed){removed?delete instance.rootById[root.uid]:instance.rootById[root.uid]=root}}]),RootAPI}();function Deloser_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function Deloser_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Deloser_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Deloser_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function Deloser_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function Deloser_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Deloser_createClass(Constructor,protoProps,staticProps){return protoProps&&Deloser_defineProperties(Constructor.prototype,protoProps),staticProps&&Deloser_defineProperties(Constructor,staticProps),Constructor}function Deloser_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Deloser_setPrototypeOf(subClass,superClass)}function Deloser_setPrototypeOf(o,p){return Deloser_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Deloser_setPrototypeOf(o,p)}function Deloser_createSuper(Derived){var hasNativeReflectConstruct=function Deloser_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Deloser_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Deloser_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Deloser_possibleConstructorReturn(this,result)}}function Deloser_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Deloser_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Deloser_getPrototypeOf(o){return Deloser_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Deloser_getPrototypeOf(o)}function Deloser_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Root_RootAPI.createRoot=function(tabster,element,props){return new Root_Root(tabster,element,props)};var DeloserItemBase=function DeloserItemBase(){Deloser_classCallCheck(this,DeloserItemBase)},Deloser_DeloserItem=function(_DeloserItemBase){Deloser_inherits(DeloserItem,_DeloserItemBase);var _resetFocus,_focusAvailable,_super=Deloser_createSuper(DeloserItem);function DeloserItem(tabster,deloser){var _this;return Deloser_classCallCheck(this,DeloserItem),(_this=_super.call(this)).uid=void 0,_this._tabster=void 0,_this._deloser=void 0,_this.uid=deloser.uid,_this._tabster=tabster,_this._deloser=deloser,_this}return Deloser_createClass(DeloserItem,[{key:"belongsTo",value:function belongsTo(deloser){return deloser===this._deloser}},{key:"unshift",value:function unshift(element){this._deloser.unshift(element)}},{key:"focusAvailable",value:(_focusAvailable=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var available;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return available=this._deloser.findAvailable(),_context.abrupt("return",!!available&&this._tabster.focusedElement.focus(available));case 2:case"end":return _context.stop()}}),_callee,this)}))),function focusAvailable(){return _focusAvailable.apply(this,arguments)})},{key:"resetFocus",value:(_resetFocus=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var getWindow;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return getWindow=this._tabster.getWindow,_context2.abrupt("return",Object(Utils.o)(getWindow).resolve(this._deloser.resetFocus()));case 2:case"end":return _context2.stop()}}),_callee2,this)}))),function resetFocus(){return _resetFocus.apply(this,arguments)})}]),DeloserItem}(DeloserItemBase),DeloserHistoryByRootBase=function(){function DeloserHistoryByRootBase(tabster,rootUId){Deloser_classCallCheck(this,DeloserHistoryByRootBase),this._tabster=void 0,this._history=[],this.rootUId=void 0,this._tabster=tabster,this.rootUId=rootUId}return Deloser_createClass(DeloserHistoryByRootBase,[{key:"getLength",value:function getLength(){return this._history.length}},{key:"removeDeloser",value:function removeDeloser(deloser){this._history=this._history.filter((function(c){return!c.belongsTo(deloser)}))}},{key:"hasDeloser",value:function hasDeloser(deloser){return this._history.some((function(d){return d.belongsTo(deloser)}))}}]),DeloserHistoryByRootBase}(),DeloserHistoryByRoot=function(_DeloserHistoryByRoot){Deloser_inherits(DeloserHistoryByRoot,_DeloserHistoryByRoot);var _resetFocus2,_focusAvailable2,_super2=Deloser_createSuper(DeloserHistoryByRoot);function DeloserHistoryByRoot(){return Deloser_classCallCheck(this,DeloserHistoryByRoot),_super2.apply(this,arguments)}return Deloser_createClass(DeloserHistoryByRoot,[{key:"unshiftToDeloser",value:function unshiftToDeloser(deloser,element){for(var item,i=0;i<this._history.length;i++)if(this._history[i].belongsTo(deloser)){item=this._history[i],this._history.splice(i,1);break}item||(item=new Deloser_DeloserItem(this._tabster,deloser)),item.unshift(element),this._history.unshift(item),this._history.splice(10,this._history.length-10)}},{key:"focusAvailable",value:(_focusAvailable2=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(from){var skip,_iterator,_step,i;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:skip=!!from,_iterator=Deloser_createForOfIteratorHelper(this._history),_context3.prev=2,_iterator.s();case 4:if((_step=_iterator.n()).done){_context3.next=16;break}if(i=_step.value,from&&i.belongsTo(from)&&(skip=!1),_context3.t0=!skip,!_context3.t0){_context3.next=12;break}return _context3.next=11,i.focusAvailable();case 11:_context3.t0=_context3.sent;case 12:if(!_context3.t0){_context3.next=14;break}return _context3.abrupt("return",!0);case 14:_context3.next=4;break;case 16:_context3.next=21;break;case 18:_context3.prev=18,_context3.t1=_context3.catch(2),_iterator.e(_context3.t1);case 21:return _context3.prev=21,_iterator.f(),_context3.finish(21);case 24:return _context3.abrupt("return",!1);case 25:case"end":return _context3.stop()}}),_callee3,this,[[2,18,21,24]])}))),function focusAvailable(_x){return _focusAvailable2.apply(this,arguments)})},{key:"resetFocus",value:(_resetFocus2=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(from){var skip,resetQueue,_iterator2,_step2,i,_i,_Object$keys,_id;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:skip=!!from,resetQueue={},_iterator2=Deloser_createForOfIteratorHelper(this._history);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)i=_step2.value,from&&i.belongsTo(from)&&(skip=!1),skip||resetQueue[i.uid]||(resetQueue[i.uid]=i)}catch(err){_iterator2.e(err)}finally{_iterator2.f()}_i=0,_Object$keys=Object.keys(resetQueue);case 5:if(!(_i<_Object$keys.length)){_context4.next=14;break}return _id=_Object$keys[_i],_context4.next=9,resetQueue[_id].resetFocus();case 9:if(!_context4.sent){_context4.next=11;break}return _context4.abrupt("return",!0);case 11:_i++,_context4.next=5;break;case 14:return _context4.abrupt("return",!1);case 15:case"end":return _context4.stop()}}),_callee4,this)}))),function resetFocus(_x2){return _resetFocus2.apply(this,arguments)})}]),DeloserHistoryByRoot}(DeloserHistoryByRootBase),Deloser_DeloserHistory=function(){function DeloserHistory(tabster){Deloser_classCallCheck(this,DeloserHistory),this._tabster=void 0,this._history=[],this._tabster=tabster}var _resetFocus3,_focusAvailable3;return Deloser_createClass(DeloserHistory,[{key:"dispose",value:function dispose(){this._history=[]}},{key:"process",value:function process(element){var _ctx$modalizer,_this2=this,ctx=Root_RootAPI.getTabsterContext(this._tabster,element),rootUId=ctx&&ctx.root.uid,deloser=Deloser_DeloserAPI.getDeloser(this._tabster,element);if(rootUId&&deloser){var historyByRoot=this.make(rootUId,(function(){return new DeloserHistoryByRoot(_this2._tabster,rootUId)}));return(!ctx||!ctx.modalizer||null!==(_ctx$modalizer=ctx.modalizer)&&void 0!==_ctx$modalizer&&_ctx$modalizer.isActive())&&historyByRoot.unshiftToDeloser(deloser,element),deloser}}},{key:"make",value:function make(rootUId,createInstance){for(var historyByRoot,i=0;i<this._history.length;i++){var hbr=this._history[i];if(hbr.rootUId===rootUId){historyByRoot=hbr,this._history.splice(i,1);break}}return historyByRoot||(historyByRoot=createInstance()),this._history.unshift(historyByRoot),this._history.splice(10,this._history.length-10),historyByRoot}},{key:"removeDeloser",value:function removeDeloser(deloser){this._history.forEach((function(i){i.removeDeloser(deloser)})),this._history=this._history.filter((function(i){return i.getLength()>0}))}},{key:"focusAvailable",value:(_focusAvailable3=_asyncToGenerator(regeneratorRuntime.mark((function _callee5(from){var skip,_iterator3,_step3,h;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:skip=!!from,_iterator3=Deloser_createForOfIteratorHelper(this._history),_context5.prev=2,_iterator3.s();case 4:if((_step3=_iterator3.n()).done){_context5.next=16;break}if(h=_step3.value,from&&h.hasDeloser(from)&&(skip=!1),_context5.t0=!skip,!_context5.t0){_context5.next=12;break}return _context5.next=11,h.focusAvailable(from);case 11:_context5.t0=_context5.sent;case 12:if(!_context5.t0){_context5.next=14;break}return _context5.abrupt("return",!0);case 14:_context5.next=4;break;case 16:_context5.next=21;break;case 18:_context5.prev=18,_context5.t1=_context5.catch(2),_iterator3.e(_context5.t1);case 21:return _context5.prev=21,_iterator3.f(),_context5.finish(21);case 24:return _context5.abrupt("return",!1);case 25:case"end":return _context5.stop()}}),_callee5,this,[[2,18,21,24]])}))),function focusAvailable(_x3){return _focusAvailable3.apply(this,arguments)})},{key:"resetFocus",value:(_resetFocus3=_asyncToGenerator(regeneratorRuntime.mark((function _callee6(from){var skip,_iterator4,_step4,h;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:skip=!!from,_iterator4=Deloser_createForOfIteratorHelper(this._history),_context6.prev=2,_iterator4.s();case 4:if((_step4=_iterator4.n()).done){_context6.next=16;break}if(h=_step4.value,from&&h.hasDeloser(from)&&(skip=!1),_context6.t0=!skip,!_context6.t0){_context6.next=12;break}return _context6.next=11,h.resetFocus(from);case 11:_context6.t0=_context6.sent;case 12:if(!_context6.t0){_context6.next=14;break}return _context6.abrupt("return",!0);case 14:_context6.next=4;break;case 16:_context6.next=21;break;case 18:_context6.prev=18,_context6.t1=_context6.catch(2),_iterator4.e(_context6.t1);case 21:return _context6.prev=21,_iterator4.f(),_context6.finish(21);case 24:return _context6.abrupt("return",!1);case 25:case"end":return _context6.stop()}}),_callee6,this,[[2,18,21,24]])}))),function resetFocus(_x4){return _resetFocus3.apply(this,arguments)})}]),DeloserHistory}();function buildElementSelector(element,withClass,withIndex){var selector=[],escapeRegExp=/(:|\.|\[|\]|,|=|@)/g;element.id&&selector.push("#"+element.id.replace(escapeRegExp,"\\$1")),!1!==withClass&&element.className&&element.className.split(" ").forEach((function(cls){(cls=cls.trim())&&selector.push("."+cls.replace(escapeRegExp,"\\$1"))}));var el,index=0;if(!1!==withIndex&&0===selector.length){for(el=element;el;)index++,el=el.previousElementSibling;selector.unshift(":nth-child("+index+")")}return selector.unshift(element.tagName.toLowerCase()),selector.join("")}var Deloser_Deloser=function(_TabsterPart){Deloser_inherits(Deloser,_TabsterPart);var _super3=Deloser_createSuper(Deloser);function Deloser(tabster,_element,onDispose,props){var _this3;return Deloser_classCallCheck(this,Deloser),(_this3=_super3.call(this,tabster,_element,props)).uid=void 0,_this3._isActive=!1,_this3._history=[[]],_this3._snapshotIndex=0,_this3._onDispose=void 0,_this3.isActive=function(){return _this3._isActive},_this3.setSnapshot=function(index){_this3._snapshotIndex=index,_this3._history.length>index+1&&_this3._history.splice(index+1,_this3._history.length-index-1),_this3._history[index]||(_this3._history[index]=[])},_this3.focusFirst=function(){var e=_this3._element.get();return!!e&&_this3._tabster.focusedElement.focusFirst({container:e})},_this3.focusDefault=function(){var e=_this3._element.get();return!!e&&_this3._tabster.focusedElement.focusDefault(e)},_this3.resetFocus=function(){var e=_this3._element.get();return!!e&&_this3._tabster.focusedElement.resetFocus(e)},_this3.clearHistory=function(preserveExisting){var element=_this3._element.get();_this3._history[_this3._snapshotIndex]=element?_this3._history[_this3._snapshotIndex].filter((function(we){var e=we.get();return!(!e||!preserveExisting)&&element.contains(e)})):[]},_this3.uid=Object(Utils.l)(tabster.getWindow,_element),_this3._onDispose=onDispose,_this3}return Deloser_createClass(Deloser,[{key:"dispose",value:function dispose(){this._remove(),this._onDispose(this),this._isActive=!1,this._snapshotIndex=0,this._props={},this._history=[]}},{key:"setActive",value:function setActive(active){this._isActive=active}},{key:"getActions",value:function getActions(){return{focusDefault:this.focusDefault,focusFirst:this.focusFirst,resetFocus:this.resetFocus,clearHistory:this.clearHistory,setSnapshot:this.setSnapshot,isActive:this.isActive}}},{key:"unshift",value:function unshift(element){var cur=this._history[this._snapshotIndex];for((cur=this._history[this._snapshotIndex]=cur.filter((function(we){var e=we.get();return e&&e!==element}))).unshift(new Utils.d(this._tabster.getWindow,element,function buildSelector(element){if(Object(Utils.j)(element.ownerDocument,element)){for(var selector=[buildElementSelector(element)],el=element.parentElement;el;){var isBody="BODY"===el.tagName;if(selector.unshift(buildElementSelector(el,!1,!isBody)),isBody)break;el=el.parentElement}return selector.join(" ")}}(element)));cur.length>10;)cur.pop()}},{key:"findAvailable",value:function findAvailable(){var element=this._element.get();if(!element||!this._tabster.focusable.isVisible(element))return null;var restoreFocusOrder=this._props.restoreFocusOrder,available=null,ctx=Root_RootAPI.getTabsterContext(this._tabster,element);if(!ctx)return null;var root=ctx.root,rootElement=root.getElement();if(!rootElement)return null;if(void 0===restoreFocusOrder&&(restoreFocusOrder=root.getProps().restoreFocusOrder),restoreFocusOrder===Types.RestoreFocusOrders.RootDefault&&(available=this._tabster.focusable.findDefault({container:rootElement})),available||restoreFocusOrder!==Types.RestoreFocusOrders.RootFirst||(available=this._findFirst(rootElement)),available)return available;var availableInHistory=this._findInHistory(),availableDefault=this._tabster.focusable.findDefault({container:element}),availableFirst=this._findFirst(element);return availableInHistory&&restoreFocusOrder===Types.RestoreFocusOrders.History?availableInHistory:availableDefault&&restoreFocusOrder===Types.RestoreFocusOrders.DeloserDefault?availableDefault:availableFirst&&restoreFocusOrder===Types.RestoreFocusOrders.DeloserFirst?availableFirst:availableDefault||availableInHistory||availableFirst||null}},{key:"customFocusLostHandler",value:function customFocusLostHandler(element){return Object(Utils.y)(element,Types.DeloserEventName,this.getActions())}},{key:"_findInHistory",value:function _findInHistory(){var cur=this._history[this._snapshotIndex].slice(0);this.clearHistory(!0);for(var i=0;i<cur.length;i++){var we=cur[i],e=we.get(),element=this._element.get();if(e&&element&&element.contains(e)){if(this._tabster.focusable.isFocusable(e))return e}else if(!this._props.noSelectorCheck){var selector=we.getData();if(selector&&element){var els=void 0;try{els=element.ownerDocument.querySelectorAll(selector)}catch(e){0;continue}for(var _i2=0;_i2<els.length;_i2++){var el=els[_i2];if(el&&this._tabster.focusable.isFocusable(el))return el}}}}return null}},{key:"_findFirst",value:function _findFirst(element){if(this._tabster.keyboardNavigation.isNavigatingWithKeyboard()){var first=this._tabster.focusable.findFirst({container:element});if(first)return first}return null}},{key:"_remove",value:function _remove(){0}}]),Deloser}(Utils.c);var Deloser_DeloserAPI=function(){function DeloserAPI(tabster,props){var _this4=this;Deloser_classCallCheck(this,DeloserAPI),this._tabster=void 0,this._win=void 0,this._initTimer=void 0,this._inDeloser=!1,this._curDeloser=void 0,this._history=void 0,this._restoreFocusTimer=void 0,this._isRestoringFocus=!1,this._isPaused=!1,this._autoDeloser=void 0,this._autoDeloserInstance=void 0,this._init=function(){_this4._initTimer=void 0,_this4._tabster.focusedElement.subscribe(_this4._onFocus)},this._onFocus=function(e){if(_this4._restoreFocusTimer&&(_this4._win().clearTimeout(_this4._restoreFocusTimer),_this4._restoreFocusTimer=void 0),e){var deloser=_this4._history.process(e);deloser?_this4._activate(deloser):_this4._deactivate()}else _this4._scheduleRestoreFocus()},this._onDeloserDispose=function(deloser){_this4._history.removeDeloser(deloser),deloser.isActive()&&_this4._scheduleRestoreFocus()},this._tabster=tabster,this._win=tabster.getWindow,this._history=new Deloser_DeloserHistory(tabster),this._initTimer=this._win().setTimeout(this._init,0);var autoDeloser=null==props?void 0:props.autoDeloser;autoDeloser&&(this._autoDeloser=autoDeloser)}return Deloser_createClass(DeloserAPI,[{key:"dispose",value:function dispose(){var win=this._win();this._initTimer&&(win.clearTimeout(this._initTimer),this._initTimer=void 0),this._restoreFocusTimer&&(win.clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0),this._autoDeloserInstance&&(this._autoDeloserInstance.dispose(),delete this._autoDeloserInstance,delete this._autoDeloser),this._tabster.focusedElement.unsubscribe(this._onFocus),this._history.dispose(),delete this._curDeloser}},{key:"getActions",value:function getActions(element){for(var e=element;e;e=e.parentElement){var tabsterOnElement=getTabsterOnElement(this._tabster,e);if(tabsterOnElement&&tabsterOnElement.deloser)return tabsterOnElement.deloser.getActions()}}},{key:"pause",value:function pause(){this._isPaused=!0,this._restoreFocusTimer&&(this._win().clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0)}},{key:"resume",value:function resume(restore){this._isPaused=!1,restore&&this._scheduleRestoreFocus()}},{key:"_activate",value:function _activate(deloser){var curDeloser=this._curDeloser;curDeloser!==deloser&&(this._inDeloser=!0,null==curDeloser||curDeloser.setActive(!1),deloser.setActive(!0),this._curDeloser=deloser)}},{key:"_deactivate",value:function _deactivate(){var _this$_curDeloser;this._inDeloser=!1,null===(_this$_curDeloser=this._curDeloser)||void 0===_this$_curDeloser||_this$_curDeloser.setActive(!1),this._curDeloser=void 0}},{key:"_scheduleRestoreFocus",value:function _scheduleRestoreFocus(force){var _this5=this;if(!this._isPaused&&!this._isRestoringFocus){var restoreFocus=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){var lastFocused,curDeloser,el;return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(_this5._restoreFocusTimer=void 0,lastFocused=_this5._tabster.focusedElement.getLastFocusedElement(),force||!(_this5._isRestoringFocus||!_this5._inDeloser||null!=lastFocused&&lastFocused.offsetParent)){_context7.next=4;break}return _context7.abrupt("return");case 4:if(!(curDeloser=_this5._curDeloser)){_context7.next=11;break}if(!lastFocused||!curDeloser.customFocusLostHandler(lastFocused)){_context7.next=8;break}return _context7.abrupt("return");case 8:if(!(el=curDeloser.findAvailable())||!_this5._tabster.focusedElement.focus(el)){_context7.next=11;break}return _context7.abrupt("return");case 11:return _this5._deactivate(),_this5._isRestoringFocus=!0,_context7.next=15,_this5._history.focusAvailable(null);case 15:if(_context7.sent){_context7.next=18;break}return _context7.next=18,_this5._history.resetFocus(null);case 18:_this5._isRestoringFocus=!1;case 19:case"end":return _context7.stop()}}),_callee7)})));return function restoreFocus(){return _ref.apply(this,arguments)}}();force?restoreFocus():this._restoreFocusTimer=this._win().setTimeout(restoreFocus,100)}}}],[{key:"dispose",value:function dispose(instance){instance.dispose()}},{key:"getDeloser",value:function getDeloser(tabster,element){for(var e=element;e;e=e.parentElement){var tabsterOnElement=getTabsterOnElement(tabster,e);if(tabsterOnElement&&tabsterOnElement.deloser)return tabsterOnElement.deloser}var tabsteri=tabster,deloserAPI=tabsteri.deloser&&tabsteri.deloser;if(deloserAPI){if(deloserAPI._autoDeloserInstance)return deloserAPI._autoDeloserInstance;var autoDeloserProps=deloserAPI._autoDeloser;if(!deloserAPI._autoDeloserInstance&&autoDeloserProps){var _element$ownerDocumen,body=null===(_element$ownerDocumen=element.ownerDocument)||void 0===_element$ownerDocumen?void 0:_element$ownerDocumen.body;body&&(deloserAPI._autoDeloserInstance=new Deloser_Deloser(tabsteri,body,tabsteri.deloser._onDeloserDispose,autoDeloserProps))}return deloserAPI._autoDeloserInstance}}},{key:"getHistory",value:function getHistory(instance){return instance._history}},{key:"forceRestoreFocus",value:function forceRestoreFocus(instance){instance._scheduleRestoreFocus(!0)}}]),DeloserAPI}();Deloser_DeloserAPI.createDeloser=function(tabster,element,props){var _tabster$focusedEleme;var deloser=new Deloser_Deloser(tabster,element,tabster.deloser._onDeloserDispose,props);return element.contains(null!==(_tabster$focusedEleme=tabster.focusedElement.getFocusedElement())&&void 0!==_tabster$focusedEleme?_tabster$focusedEleme:null)&&tabster.deloser._activate(deloser),deloser};function Focusable_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _focusableSelector=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","*[tabindex]","*[contenteditable]"].join(", "),Focusable_FocusableAPI=function(){function FocusableAPI(tabster,getWindow){!function Focusable_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FocusableAPI),this._tabster=void 0,this._win=void 0,this._tabster=tabster,this._win=getWindow}return function Focusable_createClass(Constructor,protoProps,staticProps){return protoProps&&Focusable_defineProperties(Constructor.prototype,protoProps),staticProps&&Focusable_defineProperties(Constructor,staticProps),Constructor}(FocusableAPI,[{key:"dispose",value:function dispose(){}},{key:"_getBody",value:function _getBody(){var last=this._tabster.focusedElement.getLastFocusedElement();return last&&last.ownerDocument?last.ownerDocument.body:this._win().document.body}},{key:"getProps",value:function getProps(element){var tabsterOnElement=getTabsterOnElement(this._tabster,element);return tabsterOnElement&&tabsterOnElement.focusable||{}}},{key:"isFocusable",value:function isFocusable(el,includeProgrammaticallyFocusable,noVisibleCheck,noAccessibleCheck){return!(!Object(Utils.t)(el,_focusableSelector)||!includeProgrammaticallyFocusable&&-1===el.tabIndex)&&((noVisibleCheck||this.isVisible(el))&&(noAccessibleCheck||this.isAccessible(el)))}},{key:"isVisible",value:function isVisible(el){if(!el.ownerDocument)return!1;if(null===el.offsetParent&&el.ownerDocument.body!==el)return!1;var win=el.ownerDocument.defaultView;if(!win)return!1;var rect=el.ownerDocument.body.getBoundingClientRect();return(0!==rect.width||0!==rect.height)&&"hidden"!==win.getComputedStyle(el).visibility}},{key:"isAccessible",value:function isAccessible(el){for(var e=el;e;e=e.parentElement){var _tabsterOnElement$foc,tabsterOnElement=getTabsterOnElement(this._tabster,e);if(this._isHidden(e))return!1;if(!(null==tabsterOnElement||null===(_tabsterOnElement$foc=tabsterOnElement.focusable)||void 0===_tabsterOnElement$foc?void 0:_tabsterOnElement$foc.ignoreAriaDisabled)&&this._isDisabled(e))return!1}return!0}},{key:"_isDisabled",value:function _isDisabled(el){return el.hasAttribute("disabled")}},{key:"_isHidden",value:function _isHidden(el){var attrVal=el.getAttribute("aria-hidden");return!(!attrVal||"true"!==attrVal.toLowerCase())}},{key:"findFirst",value:function findFirst(options){return this.findElement(Object.assign({container:this._getBody()},options))}},{key:"findLast",value:function findLast(options){return this.findElement(Object.assign({container:this._getBody(),prev:!0},options))}},{key:"findNext",value:function findNext(options){return this.findElement(Object.assign({container:this._getBody()},options))}},{key:"findPrev",value:function findPrev(options){return this.findElement(Object.assign({container:this._getBody(),prev:!0},options))}},{key:"findDefault",value:function findDefault(options){var _this=this;return this.findElement(Object.assign({},options,{acceptCondition:function acceptCondition(el){return _this._tabster.focusable.isFocusable(el,options.includeProgrammaticallyFocusable)&&!!_this.getProps(el).isDefault}}))||null}},{key:"findAll",value:function findAll(options){var _this2=this,container=options.container,customAcceptCondition=options.acceptCondition,includeProgrammaticallyFocusable=options.includeProgrammaticallyFocusable,ignoreGroupper=options.ignoreGroupper,ignoreUncontrolled=options.ignoreUncontrolled,ignoreAccessibiliy=options.ignoreAccessibiliy,skipDefaultCheck=options.skipDefaultCheck,acceptElementState={container:container,from:null,isForward:!0,acceptCondition:function acceptCondition(el){var defaultCheck,customCheck=!1;return(defaultCheck=!!skipDefaultCheck||_this2._tabster.focusable.isFocusable(el,includeProgrammaticallyFocusable))&&(customCheck=!customAcceptCondition||customAcceptCondition(el)),defaultCheck&&customCheck},includeProgrammaticallyFocusable:includeProgrammaticallyFocusable,ignoreGroupper:ignoreGroupper,ignoreUncontrolled:ignoreUncontrolled,ignoreAccessibiliy:ignoreAccessibiliy,grouppers:{}},walker=Object(Utils.g)(container.ownerDocument,container,(function(node){return _this2._acceptElement(node,acceptElementState)})),nodeFilter=null==walker?void 0:walker.filter;if(!walker||!nodeFilter)return[];for(var node,foundNodes=[];node=walker.nextNode();)foundNodes.push(node);return foundNodes}},{key:"findElement",value:function findElement(options){var _this3=this,container=options.container,_options$currentEleme=options.currentElement,currentElement=void 0===_options$currentEleme?null:_options$currentEleme,includeProgrammaticallyFocusable=options.includeProgrammaticallyFocusable,ignoreGroupper=options.ignoreGroupper,ignoreUncontrolled=options.ignoreUncontrolled,ignoreAccessibiliy=options.ignoreAccessibiliy,prev=options.prev,onUncontrolled=options.onUncontrolled,acceptCondition=options.acceptCondition;if(!container)return null;if(!container.ownerDocument||currentElement&&container!==currentElement&&!container.contains(currentElement))return null;acceptCondition||(acceptCondition=function acceptCondition(el){return _this3._tabster.focusable.isFocusable(el,includeProgrammaticallyFocusable,ignoreAccessibiliy,ignoreAccessibiliy)});var acceptElementState={container:container,from:currentElement,isForward:!prev,acceptCondition:acceptCondition,includeProgrammaticallyFocusable:includeProgrammaticallyFocusable,ignoreGroupper:ignoreGroupper,ignoreUncontrolled:ignoreUncontrolled,ignoreAccessibiliy:ignoreAccessibiliy,grouppers:{}},walker=Object(Utils.g)(container.ownerDocument,container,(function(node){return _this3._acceptElement(node,acceptElementState)}));if(!walker)return null;if(currentElement)walker.currentNode=currentElement;else if(prev){var lastChild=Object(Utils.n)(container);if(!lastChild)return null;if(this._acceptElement(lastChild,acceptElementState)===NodeFilter.FILTER_ACCEPT)return lastChild;walker.currentNode=lastChild}var foundElement=prev?walker.previousNode():walker.nextNode(),nextUncontrolled=acceptElementState.nextUncontrolled;return nextUncontrolled&&(foundElement=foundElement?void 0:null,onUncontrolled&&onUncontrolled(nextUncontrolled)),acceptElementState.found?acceptElementState.foundElement:foundElement}},{key:"_acceptElement",value:function _acceptElement(element,state){if(element===state.container)return NodeFilter.FILTER_SKIP;if(state.found)return NodeFilter.FILTER_ACCEPT;var ctx=Root_RootAPI.getTabsterContext(this._tabster,element);if(!ctx)return NodeFilter.FILTER_SKIP;if(state.ignoreUncontrolled){if(Object(Utils.v)(element))return NodeFilter.FILTER_SKIP}else if(ctx.groupper)state.nextGroupper=ctx.groupper.getElement();else if(ctx.mover)state.nextMover=ctx.mover.getElement();else if(ctx.uncontrolled&&!state.nextUncontrolled&&!ctx.groupper&&!ctx.mover)return state.nextUncontrolled=ctx.uncontrolled,NodeFilter.FILTER_REJECT;if("IFRAME"===element.tagName)return NodeFilter.FILTER_ACCEPT;if(!state.ignoreAccessibiliy&&!this.isAccessible(element))return NodeFilter.FILTER_REJECT;if(!state.ignoreGroupper){var groupper,mover;groupper=ctx.groupper,mover=ctx.mover;var isGroupperFirst=ctx.isGroupperFirst;if(groupper&&isGroupperFirst?mover=void 0:mover&&!isGroupperFirst&&(groupper=void 0),groupper){var result=groupper.acceptElement(element,state);if(void 0!==result)return result}if(mover){var _result=mover.acceptElement(element,state);if(void 0!==_result)return _result}}return state.acceptCondition(element)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}],[{key:"dispose",value:function dispose(instance){instance.dispose()}}]),FocusableAPI}(),Keys_Tab=9,Keys_Enter=13,Keys_Esc=27,Keys_PageUp=33,Keys_PageDown=34,Keys_End=35,Keys_Home=36,Keys_Left=37,Keys_Up=38,Keys_Right=39,Keys_Down=40;function FocusedElement_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function FocusedElement_get(){return FocusedElement_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=FocusedElement_superPropBase(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},FocusedElement_get.apply(this,arguments)}function FocusedElement_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=FocusedElement_getPrototypeOf(object)););return object}function FocusedElement_setPrototypeOf(o,p){return FocusedElement_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},FocusedElement_setPrototypeOf(o,p)}function FocusedElement_createSuper(Derived){var hasNativeReflectConstruct=function FocusedElement_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=FocusedElement_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=FocusedElement_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return FocusedElement_possibleConstructorReturn(this,result)}}function FocusedElement_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function FocusedElement_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function FocusedElement_getPrototypeOf(o){return FocusedElement_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},FocusedElement_getPrototypeOf(o)}var FocusedElement_FocusedElementState=function(_Subscribable){!function FocusedElement_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&FocusedElement_setPrototypeOf(subClass,superClass)}(FocusedElementState,_Subscribable);var _super=FocusedElement_createSuper(FocusedElementState);function FocusedElementState(tabster,getWindow){var _this;return function FocusedElement_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FocusedElementState),(_this=_super.call(this))._tabster=void 0,_this._initTimer=void 0,_this._win=void 0,_this._nextVal=void 0,_this._lastVal=void 0,_this._init=function(){_this._initTimer=void 0;var win=_this._win();win.document.addEventListener(keyborg_esm.a,_this._onFocusIn,!0),win.document.addEventListener("focusout",_this._onFocusOut,!0),_this._tabster.controlTab&&win.addEventListener("keydown",_this._onKeyDown,!0)},_this._onFocusIn=function(e){_this._setFocusedElement(e.target,e.details.relatedTarget||void 0,e.details.isFocusedProgrammatically)},_this._onFocusOut=function(e){_this._setFocusedElement(void 0,e.relatedTarget||void 0)},_this._validateFocusedElement=function(element){},_this._onKeyDown=function(e){if(e.keyCode===Keys_Tab){var curElement=_this.getVal();if(curElement&&curElement.ownerDocument&&"true"!==curElement.contentEditable){var ctx=Root_RootAPI.getTabsterContext(_this._tabster,curElement,{checkRtl:!0});if(ctx){var isPrev=e.shiftKey,next=FocusedElementState.findNextTabbable(_this._tabster,ctx,curElement,isPrev);if(next){var uncontrolled=next.uncontrolled;if(uncontrolled)ctx.uncontrolled||_this._moveToUncontrolled(uncontrolled,isPrev);else{var nextElement=next.element;if(ctx.modalizer){var _nextElementCtx$modal,nextElementCtx=nextElement&&Root_RootAPI.getTabsterContext(_this._tabster,nextElement);if((!nextElementCtx||ctx.root.uid!==nextElementCtx.root.uid||null===(_nextElementCtx$modal=nextElementCtx.modalizer)||void 0===_nextElementCtx$modal||!_nextElementCtx$modal.isActive())&&ctx.modalizer.onBeforeFocusOut())return void e.preventDefault()}nextElement?"IFRAME"!==nextElement.tagName&&(e.preventDefault(),Object(keyborg_esm.d)(nextElement)):ctx.root.moveOutWithDefaultAction(isPrev)}}}}}},_this._tabster=tabster,_this._win=getWindow,_this._initTimer=getWindow().setTimeout(_this._init,0),_this}return function FocusedElement_createClass(Constructor,protoProps,staticProps){return protoProps&&FocusedElement_defineProperties(Constructor.prototype,protoProps),staticProps&&FocusedElement_defineProperties(Constructor,staticProps),Constructor}(FocusedElementState,[{key:"dispose",value:function dispose(){FocusedElement_get(FocusedElement_getPrototypeOf(FocusedElementState.prototype),"dispose",this).call(this);var win=this._win();this._initTimer&&(win.clearTimeout(this._initTimer),this._initTimer=void 0),win.document.removeEventListener(keyborg_esm.a,this._onFocusIn,!0),win.document.removeEventListener("focusout",this._onFocusOut,!0),this._tabster.controlTab&&win.addEventListener("keydown",this._onKeyDown,!0),delete FocusedElementState._lastResetElement,delete this._nextVal,delete this._lastVal}},{key:"getFocusedElement",value:function getFocusedElement(){return this.getVal()}},{key:"getLastFocusedElement",value:function getLastFocusedElement(){var _this$_lastVal,el=null===(_this$_lastVal=this._lastVal)||void 0===_this$_lastVal?void 0:_this$_lastVal.get();return(!el||el&&!Object(Utils.j)(el.ownerDocument,el))&&(this._lastVal=el=void 0),el}},{key:"focus",value:function focus(element,noFocusedProgrammaticallyFlag,noAccessibleCheck){return!!this._tabster.focusable.isFocusable(element,noFocusedProgrammaticallyFlag,!1,noAccessibleCheck)&&(element.focus(),!0)}},{key:"focusDefault",value:function focusDefault(container){var el=this._tabster.focusable.findDefault({container:container});return!!el&&(this._tabster.focusedElement.focus(el),!0)}},{key:"focusFirst",value:function focusFirst(props){var toFocus,container=props.container;if(container){var ctx=Root_RootAPI.getTabsterContext(this._tabster,container,{checkRtl:!0});if(ctx){var next=FocusedElementState.findNextTabbable(this._tabster,ctx,container);next&&!next.uncontrolled&&(toFocus=next.element)}}return toFocus||(toFocus=this._tabster.focusable.findFirst(props))||(toFocus=this._tabster.focusable.findFirst(Object.assign({},props,{ignoreUncontrolled:!0,ignoreAccessibiliy:!0}))),!!toFocus&&(this.focus(toFocus,!1,!0),!0)}},{key:"focusLast",value:function focusLast(props){var toFocus,container=props.container;if(container){var ctx=Root_RootAPI.getTabsterContext(this._tabster,container,{checkRtl:!0});if(ctx){var next=FocusedElementState.findNextTabbable(this._tabster,ctx,Object(Utils.n)(container),!0);next&&!next.uncontrolled&&(toFocus=next.element)}}return toFocus||(toFocus=this._tabster.focusable.findLast(props))||(toFocus=this._tabster.focusable.findLast(Object.assign({},props,{ignoreUncontrolled:!0,ignoreAccessibiliy:!0}))),!!toFocus&&(this.focus(toFocus,!1,!0),!0)}},{key:"resetFocus",value:function resetFocus(container){if(!this._tabster.focusable.isVisible(container))return!1;if(this._tabster.focusable.isFocusable(container,!0,!0,!0))this.focus(container);else{var prevTabIndex=container.getAttribute("tabindex"),prevAriaHidden=container.getAttribute("aria-hidden");container.tabIndex=-1,container.setAttribute("aria-hidden","true"),FocusedElementState._lastResetElement=new Utils.d(this._win,container),this.focus(container,!0,!0),this._setOrRemoveAttribute(container,"tabindex",prevTabIndex),this._setOrRemoveAttribute(container,"aria-hidden",prevAriaHidden)}return!0}},{key:"_setOrRemoveAttribute",value:function _setOrRemoveAttribute(element,name,value){null===value?element.removeAttribute(name):element.setAttribute(name,value)}},{key:"_setFocusedElement",value:function _setFocusedElement(element,relatedTarget,isFocusedProgrammatically){if(!this._tabster._noop){var details={relatedTarget:relatedTarget};if(element){var _FocusedElementState$,lastResetElement=null===(_FocusedElementState$=FocusedElementState._lastResetElement)||void 0===_FocusedElementState$?void 0:_FocusedElementState$.get();if(FocusedElementState._lastResetElement=void 0,lastResetElement===element||Object(Utils.v)(element))return;details.isFocusedProgrammatically=isFocusedProgrammatically}var nextVal=this._nextVal={element:element?new Utils.d(this._win,element):void 0,details:details};element&&element!==this._val&&this._validateFocusedElement(element),this._nextVal===nextVal&&this.setVal(element,details),this._nextVal=void 0}}},{key:"setVal",value:function setVal(val,details){FocusedElement_get(FocusedElement_getPrototypeOf(FocusedElementState.prototype),"setVal",this).call(this,val,details),val&&(this._lastVal=new Utils.d(this._win,val))}},{key:"_moveToUncontrolled",value:function _moveToUncontrolled(uncontrolled,isPrev){var input=new Utils.a(this._win,{isPhantom:!0,isFirst:!0}).input;if(input){var parent=uncontrolled.parentElement;parent&&(parent.insertBefore(input,isPrev?uncontrolled.nextElementSibling:uncontrolled),Object(keyborg_esm.d)(input))}}}],[{key:"dispose",value:function dispose(instance){instance.dispose()}},{key:"forgetMemorized",value:function forgetMemorized(instance,parent){var _nextVal,_nextVal$element,wel=FocusedElementState._lastResetElement,el=wel&&wel.get();el&&parent.contains(el)&&delete FocusedElementState._lastResetElement,(el=null===(_nextVal=instance._nextVal)||void 0===_nextVal||null===(_nextVal$element=_nextVal.element)||void 0===_nextVal$element?void 0:_nextVal$element.get())&&parent.contains(el)&&delete instance._nextVal,(el=(wel=instance._lastVal)&&wel.get())&&parent.contains(el)&&delete instance._lastVal}},{key:"findNextTabbable",value:function findNextTabbable(tabster,ctx,from,prev){var current,next=null;if(from)current=from;else{var container=ctx.root.getElement();if(!container)return null;current=Object(Utils.n)(container)||container}if(ctx.groupper&&ctx.mover)ctx.isGroupperFirst?null===(next=ctx.groupper.findNextTabbable(current,prev))&&(next=ctx.mover.findNextTabbable(current,prev)):null===(next=ctx.mover.findNextTabbable(current,prev))&&(next=ctx.groupper.findNextTabbable(current,prev));else if(ctx.groupper)next=ctx.groupper.findNextTabbable(current,prev);else if(ctx.mover)next=ctx.mover.findNextTabbable(current,prev);else{var uncontrolled,onUncontrolled=function onUncontrolled(el){uncontrolled=el};next={element:prev?tabster.focusable.findPrev({currentElement:current,onUncontrolled:onUncontrolled}):tabster.focusable.findNext({currentElement:current,onUncontrolled:onUncontrolled}),uncontrolled:uncontrolled}}return next}}]),FocusedElementState}(Subscribable);function Groupper_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Groupper_createClass(Constructor,protoProps,staticProps){return protoProps&&Groupper_defineProperties(Constructor.prototype,protoProps),staticProps&&Groupper_defineProperties(Constructor,staticProps),Constructor}function Groupper_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Groupper_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Groupper_setPrototypeOf(subClass,superClass)}function Groupper_setPrototypeOf(o,p){return Groupper_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Groupper_setPrototypeOf(o,p)}function Groupper_createSuper(Derived){var hasNativeReflectConstruct=function Groupper_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Groupper_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Groupper_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Groupper_possibleConstructorReturn(this,result)}}function Groupper_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Groupper_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Groupper_getPrototypeOf(o){return Groupper_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Groupper_getPrototypeOf(o)}FocusedElement_FocusedElementState._lastResetElement=void 0;var GroupperDummyManager=function(_DummyInputManager){Groupper_inherits(GroupperDummyManager,_DummyInputManager);var _super=Groupper_createSuper(GroupperDummyManager);function GroupperDummyManager(element,tabster){var _this;return Groupper_classCallCheck(this,GroupperDummyManager),(_this=_super.call(this,tabster,element))._tabster=void 0,_this._onFocusDummyInput=function(dummyInput){var container=_this._element.get();container&&!dummyInput.shouldMoveOut&&(dummyInput.isFirst?_this._tabster.focusedElement.focusFirst({container:container}):_this._tabster.focusedElement.focusLast({container:container}))},_this._tabster=tabster,_this.firstDummy.onFocusIn=_this._onFocusDummyInput,_this.lastDummy.onFocusIn=_this._onFocusDummyInput,_this}return GroupperDummyManager}(Utils.b),Groupper_Groupper=function(_TabsterPart){Groupper_inherits(Groupper,_TabsterPart);var _super2=Groupper_createSuper(Groupper);function Groupper(tabster,element,props){var _this2;return Groupper_classCallCheck(this,Groupper),(_this2=_super2.call(this,tabster,element,props))._shouldTabInside=!1,_this2._first=void 0,_this2._dummyManager=void 0,_this2.makeTabbable(!1),tabster.controlTab||(_this2._dummyManager=new GroupperDummyManager(_this2._element,tabster)),_this2}return Groupper_createClass(Groupper,[{key:"dispose",value:function dispose(){var _this$_dummyManager;this._element.get();null===(_this$_dummyManager=this._dummyManager)||void 0===_this$_dummyManager||_this$_dummyManager.dispose(),delete this._first}},{key:"findNextTabbable",value:function findNextTabbable(current,prev){var container=this.getElement();if(!container||!container.contains(current))return null;var uncontrolled,tabster=this._tabster,next=null,onUncontrolled=function onUncontrolled(el){uncontrolled=el};if(this._shouldTabInside){var groupperFirstFocusable=this.getFirst();if(groupperFirstFocusable){var actualContainer,findSiblingFrom=prev?groupperFirstFocusable:Object(Utils.n)(groupperFirstFocusable);if(findSiblingFrom)actualContainer=(prev?tabster.focusable.findPrev({container:container,currentElement:findSiblingFrom,ignoreUncontrolled:!0}):tabster.focusable.findNext({container:container,currentElement:findSiblingFrom,ignoreUncontrolled:!0}))?container:groupperFirstFocusable;else actualContainer=container;actualContainer&&(next=prev?tabster.focusable.findPrev({container:actualContainer,currentElement:current,onUncontrolled:onUncontrolled}):tabster.focusable.findNext({container:actualContainer,currentElement:current,onUncontrolled:onUncontrolled}),uncontrolled||next||this._props.tabbability!==Types.GroupperTabbabilities.LimitedTrapFocus||(next=prev?tabster.focusable.findLast({container:actualContainer}):tabster.focusable.findFirst({container:actualContainer})))}}if(null===next){var parentElement=container.parentElement;if(parentElement){var parentCtx=Root_RootAPI.getTabsterContext(tabster,parentElement);if(parentCtx)return FocusedElement_FocusedElementState.findNextTabbable(tabster,parentCtx,current,prev)}}return{element:next,uncontrolled:uncontrolled}}},{key:"makeTabbable",value:function makeTabbable(isTabbable){this._shouldTabInside=isTabbable}},{key:"shouldTabInside",value:function shouldTabInside(){return this._shouldTabInside}},{key:"isActive",value:function isActive(){for(var element=this.getElement()||null,isParentActive=!0,e=null==element?void 0:element.parentElement;e;e=e.parentElement){var _getTabsterOnElement,g=null===(_getTabsterOnElement=getTabsterOnElement(this._tabster,e))||void 0===_getTabsterOnElement?void 0:_getTabsterOnElement.groupper;g&&(g._shouldTabInside||(isParentActive=!1))}return isParentActive?!!this._props.tabbability&&this._shouldTabInside:void 0}},{key:"getFirst",value:function getFirst(){var first,_this$_first,groupperElement=this.getElement();groupperElement&&((first=null===(_this$_first=this._first)||void 0===_this$_first?void 0:_this$_first.get())||(first=(this._tabster.focusable.isFocusable(groupperElement)?groupperElement:this._tabster.focusable.findFirst({container:groupperElement,ignoreUncontrolled:!0}))||void 0));return first}},{key:"setFirst",value:function setFirst(element){element?this._first=new Utils.d(this._tabster.getWindow,element):delete this._first}},{key:"acceptElement",value:function acceptElement(element,state){var grouppers=state.grouppers,container=state.container,cached=grouppers[this.id];if(!cached){var isActive=this.isActive(),groupperElement=this.getElement();if(groupperElement){var isInside=groupperElement!==container&&container.contains(groupperElement);if(cached=grouppers[this.id]={isInside:isInside,isActive:isActive},isInside&&!0!==isActive){var first=this.getFirst();if(first&&state.acceptCondition(first)){var focused=this._tabster.focusedElement.getFocusedElement();cached.first=first,focused&&this.setFirst(groupperElement.contains(focused)?void 0:first)}}}}if(cached.isInside){if(void 0===cached.isActive)return NodeFilter.FILTER_REJECT;if(!1===cached.isActive)return cached.first===element?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}}]),Groupper}(Utils.c);var Groupper_GroupperAPI=function(){function GroupperAPI(tabster,getWindow){var _this3=this;Groupper_classCallCheck(this,GroupperAPI),this._tabster=void 0,this._initTimer=void 0,this._win=void 0,this._current={},this._init=function(){_this3._initTimer=void 0;var win=_this3._win();_this3._tabster.focusedElement.subscribe(_this3._onFocus),win.document.addEventListener("mousedown",_this3._onMouseDown,!0),win.addEventListener("keydown",_this3._onKeyDown,!0)},this._onFocus=function(element){element&&_this3._updateCurrent(element,!1,!0)},this._onMouseDown=function(e){e.target&&_this3._updateCurrent(e.target,!0)},this._onKeyDown=function(e){if(e.keyCode===Keys_Enter||e.keyCode===Keys_Esc||e.keyCode===Keys_Tab){var isPrev=e.shiftKey,element=_this3._tabster.focusedElement.getFocusedElement();if(element){var ctx=Root_RootAPI.getTabsterContext(_this3._tabster,element),groupper=null==ctx?void 0:ctx.groupper;if(ctx&&groupper){var next,_dummyManager;if(e.keyCode===Keys_Enter){var groupperFirstFocusable=groupper.getFirst();if(groupperFirstFocusable!==element||groupper.isActive())return;(next=_this3._tabster.focusable.findFirst({container:groupperFirstFocusable,ignoreGroupper:!0}))&&_this3._updateCurrent(next)}else if(e.keyCode===Keys_Esc)for(var _e=element;_e;_e=_e.parentElement){var _getTabsterOnElement2,g=null===(_getTabsterOnElement2=getTabsterOnElement(_this3._tabster,_e))||void 0===_getTabsterOnElement2?void 0:_getTabsterOnElement2.groupper;if(g&&(g.isActive()||!g.getProps().tabbability)&&(g.makeTabbable(!1),next=g.getFirst()))break}else if(e.keyCode===Keys_Tab&&!_this3._tabster.controlTab){var _FocusedElementState$;next=null===(_FocusedElementState$=FocusedElement_FocusedElementState.findNextTabbable(_this3._tabster,ctx,element,isPrev))||void 0===_FocusedElementState$?void 0:_FocusedElementState$.element}if(next)e.preventDefault(),Object(keyborg_esm.d)(next);else null===(_dummyManager=groupper._dummyManager)||void 0===_dummyManager||_dummyManager.moveOutWithDefaultAction(isPrev)}}}},this._tabster=tabster,this._win=getWindow,this._initTimer=getWindow().setTimeout(this._init,0)}return Groupper_createClass(GroupperAPI,[{key:"dispose",value:function dispose(){var win=this._win();this._current={},this._initTimer&&(win.clearTimeout(this._initTimer),this._initTimer=void 0),this._tabster.focusedElement.unsubscribe(this._onFocus),win.document.removeEventListener("mousedown",this._onMouseDown,!0),win.removeEventListener("keydown",this._onKeyDown,!0)}},{key:"forgetCurrentGrouppers",value:function forgetCurrentGrouppers(){this._current={}}},{key:"_updateCurrent",value:function _updateCurrent(element,includeTarget,checkTarget){for(var newIds={},isTarget=!0,el=element;el;el=el.parentElement){var _getTabsterOnElement3,groupper=null===(_getTabsterOnElement3=getTabsterOnElement(this._tabster,el))||void 0===_getTabsterOnElement3?void 0:_getTabsterOnElement3.groupper;groupper&&(newIds[groupper.id]=!0,!isTarget||!checkTarget||groupper.shouldTabInside()||groupper.getProps().tabbability&&(el===element||!this._tabster.focusable.isFocusable(el)&&element===groupper.getFirst())||(isTarget=!1),!includeTarget&&isTarget||(this._current[groupper.id]=groupper,groupper.makeTabbable(!0)),isTarget=!1)}for(var _i=0,_Object$keys=Object.keys(this._current);_i<_Object$keys.length;_i++){var id=_Object$keys[_i],_groupper=this._current[id];_groupper.id in newIds||(_groupper.makeTabbable(!1),_groupper.setFirst(void 0),delete this._current[id])}}}],[{key:"dispose",value:function dispose(instance){instance.dispose()}}]),GroupperAPI}();function Modalizer_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Modalizer_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Modalizer_createClass(Constructor,protoProps,staticProps){return protoProps&&Modalizer_defineProperties(Constructor.prototype,protoProps),staticProps&&Modalizer_defineProperties(Constructor,staticProps),Constructor}function Modalizer_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Modalizer_setPrototypeOf(subClass,superClass)}function Modalizer_setPrototypeOf(o,p){return Modalizer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Modalizer_setPrototypeOf(o,p)}function Modalizer_createSuper(Derived){var hasNativeReflectConstruct=function Modalizer_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Modalizer_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Modalizer_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Modalizer_possibleConstructorReturn(this,result)}}function Modalizer_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Modalizer_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Modalizer_getPrototypeOf(o){return Modalizer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Modalizer_getPrototypeOf(o)}Groupper_GroupperAPI.createGroupper=function(tabster,element,props){return new Groupper_Groupper(tabster,element,props)};var _lastInternalId=0;var Modalizer_Modalizer=function(_TabsterPart){Modalizer_inherits(Modalizer,_TabsterPart);var _super=Modalizer_createSuper(Modalizer);function Modalizer(tabster,element,onDispose,moveOutWithDefault,onActiveChange,props){var _this;Modalizer_classCallCheck(this,Modalizer),(_this=_super.call(this,tabster,element,props)).internalId=void 0,_this.userId=void 0,_this._isActive=void 0,_this._isFocused=!1,_this._modalizerParent=void 0,_this._onDispose=void 0,_this._moveOutWithDefault=void 0,_this._onActiveChange=void 0,_this._onKeyDown=function(e){var keyCode=e.keyCode,isPrev=e.shiftKey;if(keyCode===Keys_Tab){var next,focusedElement=_this._tabster.focusedElement.getFocusedElement(),modalizerElement=_this.getElement(),findFn=isPrev?"findPrev":"findNext";focusedElement&&null!=modalizerElement&&modalizerElement.contains(focusedElement)&&(next=_this._tabster.focusable[findFn]({container:_this.getElement(),currentElement:focusedElement})),next?(e.preventDefault(),Object(keyborg_esm.d)(next)):_this._props.isOthersAccessible||_this._moveOutWithDefault(isPrev)}},_this.internalId="ml"+ ++_lastInternalId,_this.userId=props.id,_this._onDispose=onDispose,_this._moveOutWithDefault=moveOutWithDefault,_this._onActiveChange=onActiveChange,tabster.controlTab||element.addEventListener("keydown",_this._onKeyDown);var parentElement=element.parentElement;return _this._modalizerParent=parentElement?new Utils.d(tabster.getWindow,parentElement):null,_this._setAccessibilityProps(),_this}return Modalizer_createClass(Modalizer,[{key:"setProps",value:function setProps(props){props.id&&(this.userId=props.id),this._props=Object.assign({},props),this._setAccessibilityProps()}},{key:"dispose",value:function dispose(){this._onDispose(this),this._remove()}},{key:"setActive",value:function setActive(active){var _this$_element$get,_this$_modalizerParen,_this$_modalizerParen2,_this2=this;if(active!==this._isActive){this._isActive=active,this._onActiveChange(active);var targetDocument=(null===(_this$_element$get=this._element.get())||void 0===_this$_element$get?void 0:_this$_element$get.ownerDocument)||(null===(_this$_modalizerParen=this._modalizerParent)||void 0===_this$_modalizerParen||null===(_this$_modalizerParen2=_this$_modalizerParen.get())||void 0===_this$_modalizerParen2?void 0:_this$_modalizerParen2.ownerDocument);targetDocument||(targetDocument=this._tabster.getWindow().document);var root=targetDocument.body,ariaHiddenWalker=Object(Utils.g)(targetDocument,root,(function(el){var _this2$_modalizerPare;if(_this2._props.isOthersAccessible)return NodeFilter.FILTER_REJECT;var modalizerRoot=_this2._element.get(),modalizerParent=null===(_this2$_modalizerPare=_this2._modalizerParent)||void 0===_this2$_modalizerPare?void 0:_this2$_modalizerPare.get(),isModalizerElement=modalizerRoot===el,containsModalizerRoot=!!el.contains(modalizerRoot||null),containsModalizerParent=!!el.contains(modalizerParent||null);if(isModalizerElement)return NodeFilter.FILTER_REJECT;if(containsModalizerRoot||containsModalizerParent)return NodeFilter.FILTER_SKIP;!function augmentAttribute(tabster,element,name,value){var entry=tabster.storageEntry(element,!0);if(!entry.aug){if(void 0===value)return;entry.aug={}}if(void 0===value){if(name in entry.aug){var origVal=entry.aug[name];delete entry.aug[name],null===origVal?element.removeAttribute(name):element.setAttribute(name,origVal)}}else name in entry.aug||(entry.aug[name]=element.getAttribute(name)),null===value?element.removeAttribute(name):element.setAttribute(name,value);void 0===value&&0===Object.keys(entry.aug).length&&(delete entry.aug,tabster.storageEntry(element,!1))}(_this2._tabster,el,"aria-hidden",active?"true":void 0);var modalizerRootOnPage=modalizerRoot!==(null==modalizerRoot?void 0:modalizerRoot.ownerDocument.body)&&(null==modalizerRoot?void 0:modalizerRoot.ownerDocument.body.contains(modalizerRoot));return modalizerParent!==(null==modalizerParent?void 0:modalizerParent.ownerDocument.body)&&(null==modalizerParent?void 0:modalizerParent.ownerDocument.body.contains(modalizerParent))||modalizerRootOnPage?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_SKIP}));if(ariaHiddenWalker)for(;ariaHiddenWalker.nextNode(););}}},{key:"isActive",value:function isActive(){return!!this._isActive}},{key:"contains",value:function contains(element){var _this$getElement;return!(null===(_this$getElement=this.getElement())||void 0===_this$getElement||!_this$getElement.contains(element))}},{key:"onBeforeFocusOut",value:function onBeforeFocusOut(){var element=this.getElement();return!!element&&!Object(Utils.y)(element,Types.ModalizerEventName,{eventName:"beforefocusout"})}},{key:"_remove",value:function _remove(){0}},{key:"_setAccessibilityProps",value:function _setAccessibilityProps(){}}]),Modalizer}(Utils.c);var ModalizerAPIDummyManager=function(_DummyInputManager){Modalizer_inherits(ModalizerAPIDummyManager,_DummyInputManager);var _super2=Modalizer_createSuper(ModalizerAPIDummyManager);function ModalizerAPIDummyManager(modalizerAPI,tabster,element){var _this3;return Modalizer_classCallCheck(this,ModalizerAPIDummyManager),(_this3=_super2.call(this,tabster,element))._modalizerAPI=void 0,_this3._tabster=void 0,_this3._onFocusDummyInput=function(dummyInput){var activeModalizer=_this3._modalizerAPI.activeModalizer;if(activeModalizer&&!dummyInput.shouldMoveOut){var findFn=dummyInput.isFirst?"findFirst":"findLast",next=_this3._tabster.focusable[findFn]({container:activeModalizer.getElement()});next&&_this3._tabster.focusedElement.focus(next)}},_this3.setTabbable=function(tabbable){var tabIndex=tabbable?0:-1;_this3.firstDummy.input&&(_this3.firstDummy.input.tabIndex=tabIndex),_this3.lastDummy.input&&(_this3.lastDummy.input.tabIndex=tabIndex)},_this3._modalizerAPI=modalizerAPI,_this3._tabster=tabster,_this3.firstDummy.onFocusIn=_this3._onFocusDummyInput,_this3.lastDummy.onFocusIn=_this3._onFocusDummyInput,_this3.setTabbable(!1),_this3}return ModalizerAPIDummyManager}(Utils.b),Modalizer_ModalizerAPI=function(){function ModalizerAPI(tabster){var _this4=this;Modalizer_classCallCheck(this,ModalizerAPI),this._tabster=void 0,this._win=void 0,this._initTimer=void 0,this._dummyManager=void 0,this.activeModalizer=void 0,this._focusOutTimer=void 0,this._restoreModalizerFocusTimer=void 0,this._modalizers=void 0,this._init=function(){_this4._initTimer=void 0,_this4._tabster.focusedElement.subscribe(_this4._onFocus)},this._onModalizerDispose=function(modalizer){modalizer.setActive(!1),_this4.activeModalizer===modalizer&&(_this4.activeModalizer=void 0),delete _this4._modalizers[modalizer.userId]},this._onFocus=function(focusedElement,details){var _this4$activeModalize,_this4$activeModalize3,ctx=focusedElement&&Root_RootAPI.getTabsterContext(_this4._tabster,focusedElement);if(ctx&&focusedElement){_this4._focusOutTimer&&(_this4._win().clearTimeout(_this4._focusOutTimer),_this4._focusOutTimer=void 0);var _this4$activeModalize2,modalizer=null==ctx?void 0:ctx.modalizer;if(modalizer!==_this4.activeModalizer)if(!details.isFocusedProgrammatically||null!==(_this4$activeModalize=_this4.activeModalizer)&&void 0!==_this4$activeModalize&&_this4$activeModalize.contains(focusedElement)){if(null===(_this4$activeModalize3=_this4.activeModalizer)||void 0===_this4$activeModalize3||!_this4$activeModalize3.getProps().isOthersAccessible){var win=_this4._win();win.clearTimeout(_this4._restoreModalizerFocusTimer),_this4._restoreModalizerFocusTimer=win.setTimeout((function(){return _this4._restoreModalizerFocus(focusedElement)}),100)}}else null===(_this4$activeModalize2=_this4.activeModalizer)||void 0===_this4$activeModalize2||_this4$activeModalize2.setActive(!1),_this4.activeModalizer=void 0,modalizer&&(_this4.activeModalizer=modalizer,_this4.activeModalizer.setActive(!0))}},this._tabster=tabster,this._win=tabster.getWindow,this._initTimer=this._win().setTimeout(this._init,0),this._modalizers={};var documentBody=this._win().document.body;tabster.controlTab||(this._dummyManager=new ModalizerAPIDummyManager(this,tabster,new Utils.d(this._win,documentBody)))}return Modalizer_createClass(ModalizerAPI,[{key:"dispose",value:function dispose(){var _this$_dummyManager,_this5=this,win=this._win();null===(_this$_dummyManager=this._dummyManager)||void 0===_this$_dummyManager||_this$_dummyManager.dispose(),this._initTimer&&(win.clearTimeout(this._initTimer),this._initTimer=void 0),win.clearTimeout(this._restoreModalizerFocusTimer),win.clearTimeout(this._focusOutTimer),Object.keys(this._modalizers).forEach((function(modalizerId){_this5._modalizers[modalizerId]&&(_this5._modalizers[modalizerId].dispose(),delete _this5._modalizers[modalizerId])})),this._tabster.focusedElement.unsubscribe(this._onFocus),delete this.activeModalizer}},{key:"focus",value:function focus(elementFromModalizer,noFocusFirst,noFocusDefault){var ctx=Root_RootAPI.getTabsterContext(this._tabster,elementFromModalizer);if(ctx&&ctx.modalizer){this.activeModalizer=ctx.modalizer,this.activeModalizer.setActive(!0);var props=this.activeModalizer.getProps(),modalizerRoot=this.activeModalizer.getElement();if(modalizerRoot){if(void 0===noFocusFirst&&(noFocusFirst=props.isNoFocusFirst),!noFocusFirst&&this._tabster.keyboardNavigation.isNavigatingWithKeyboard()&&this._tabster.focusedElement.focusFirst({container:modalizerRoot}))return!0;if(void 0===noFocusDefault&&(noFocusDefault=props.isNoFocusDefault),!noFocusDefault&&this._tabster.focusedElement.focusDefault(modalizerRoot))return!0;this._tabster.focusedElement.resetFocus(modalizerRoot)}}else 0;return!1}},{key:"_restoreModalizerFocus",value:function _restoreModalizerFocus(outsideElement){if(null!=outsideElement&&outsideElement.ownerDocument&&this.activeModalizer){var toFocus=this._tabster.focusable.findFirst({container:this.activeModalizer.getElement()});if(toFocus){if(outsideElement.compareDocumentPosition(toFocus)&document.DOCUMENT_POSITION_PRECEDING&&!(toFocus=this._tabster.focusable.findLast({container:outsideElement.ownerDocument.body})))throw new Error("Something went wrong.");this._tabster.focusedElement.focus(toFocus)}else outsideElement.blur()}}}],[{key:"dispose",value:function dispose(instance){instance.dispose()}},{key:"updateModalizer",value:function updateModalizer(tabster,modalizer,removed){if(removed&&tabster.modalizer){var self=tabster.modalizer;modalizer.isActive()&&modalizer.setActive(!1),delete self._modalizers[modalizer.userId],self.activeModalizer===modalizer&&(self.activeModalizer=void 0)}}}]),ModalizerAPI}();function Mover_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function Mover_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Mover_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mover_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function Mover_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Mover_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Mover_createClass(Constructor,protoProps,staticProps){return protoProps&&Mover_defineProperties(Constructor.prototype,protoProps),staticProps&&Mover_defineProperties(Constructor,staticProps),Constructor}function Mover_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Mover_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Mover_setPrototypeOf(subClass,superClass)}function Mover_setPrototypeOf(o,p){return Mover_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},Mover_setPrototypeOf(o,p)}function Mover_createSuper(Derived){var hasNativeReflectConstruct=function Mover_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Mover_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=Mover_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Mover_possibleConstructorReturn(this,result)}}function Mover_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function Mover_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function Mover_getPrototypeOf(o){return Mover_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Mover_getPrototypeOf(o)}Modalizer_ModalizerAPI.createModalizer=function(tabster,element,props){var _self$_dummyManager$m,_self$_dummyManager,_self$_dummyManager$s,_self$_dummyManager2,_tabster$focusedEleme;var self=tabster.modalizer,modalizer=new Modalizer_Modalizer(tabster,element,self._onModalizerDispose,null!==(_self$_dummyManager$m=null===(_self$_dummyManager=self._dummyManager)||void 0===_self$_dummyManager?void 0:_self$_dummyManager.moveOutWithDefaultAction)&&void 0!==_self$_dummyManager$m?_self$_dummyManager$m:function(){return null},null!==(_self$_dummyManager$s=null===(_self$_dummyManager2=self._dummyManager)||void 0===_self$_dummyManager2?void 0:_self$_dummyManager2.setTabbable)&&void 0!==_self$_dummyManager$s?_self$_dummyManager$s:function(){return null},props);if(self._modalizers[props.id]=modalizer,element.contains(null!==(_tabster$focusedEleme=tabster.focusedElement.getFocusedElement())&&void 0!==_tabster$focusedEleme?_tabster$focusedEleme:null)){var prevModalizer=self.activeModalizer;prevModalizer&&prevModalizer.setActive(!1),self.activeModalizer=modalizer,self.activeModalizer.setActive(!0)}return modalizer};var _inputSelector=["input","textarea","*[contenteditable]"].join(", "),Mover_MoverDummyManager=function(_DummyInputManager){Mover_inherits(MoverDummyManager,_DummyInputManager);var _super=Mover_createSuper(MoverDummyManager);function MoverDummyManager(element,tabster,getMemorized){var _this;return Mover_classCallCheck(this,MoverDummyManager),(_this=_super.call(this,tabster,element))._tabster=void 0,_this._getMemorized=void 0,_this._onFocusDummyInput=function(dummyInput){var container=_this._element.get();if(container&&!dummyInput.shouldMoveOut){var _this$_getMemorized,toFocus=dummyInput.isFirst?_this._tabster.focusable.findFirst({container:container}):_this._tabster.focusable.findLast({container:container}),memorized=null===(_this$_getMemorized=_this._getMemorized())||void 0===_this$_getMemorized?void 0:_this$_getMemorized.get();memorized&&(toFocus=memorized),toFocus&&Object(keyborg_esm.d)(toFocus)}},_this._tabster=tabster,_this._getMemorized=getMemorized,_this.firstDummy.onFocusIn=_this._onFocusDummyInput,_this.lastDummy.onFocusIn=_this._onFocusDummyInput,_this}return MoverDummyManager}(Utils.b),Mover_Mover=function(_TabsterPart){Mover_inherits(Mover,_TabsterPart);var _super2=Mover_createSuper(Mover);function Mover(tabster,_element,onDispose,props){var _this2;Mover_classCallCheck(this,Mover),(_this2=_super2.call(this,tabster,_element,props))._unobserve=void 0,_this2._onChangeTimer=void 0,_this2._domChangedTimer=void 0,_this2._current=void 0,_this2._prevCurrent=void 0,_this2._visible={},_this2._prevVisible={},_this2._hasFullyVisible=!1,_this2._updateVisibleTimer=void 0,_this2._focusables={},_this2._win=void 0,_this2._onDispose=void 0,_this2._dummyManagner=void 0,_this2._domChanged=function(){_this2._domChangedTimer=void 0;var element=_this2.getElement();if(element){for(var elements=_this2._tabster.focusable.findAll({container:element}),newFocusables={},prevFocusables=_this2._focusables,i=0;i<elements.length;i++){var el=elements[i],_id=Object(Utils.l)(_this2._win,el),weakEl=prevFocusables[_id];weakEl||(weakEl=new Utils.d(_this2._win,el)),newFocusables[_id]=weakEl}for(var _i=0,_Object$keys=Object.keys(prevFocusables);_i<_Object$keys.length;_i++){var _id2=_Object$keys[_i];if(!(_id2 in newFocusables)){var _this2$_current,prevFocusable=prevFocusables[_id2].get();delete prevFocusables[_id2],delete _this2._visible[_id2],prevFocusable&&(null===(_this2$_current=_this2._current)||void 0===_this2$_current?void 0:_this2$_current.get())===prevFocusable&&_this2.setCurrent(void 0)}}_this2._focusables=newFocusables,_this2.updateVisible(!0)}},_this2._win=tabster.getWindow,(_this2._props.trackState||_this2._props.visibilityAware)&&(_this2._observeState(),_this2._domChangedTimer=tabster.getWindow().setTimeout(_this2._domChanged,0)),_this2._onDispose=onDispose;return tabster.controlTab||(_this2._dummyManagner=new Mover_MoverDummyManager(_this2._element,tabster,(function getMemorized(){return props.memorizeCurrent?_this2._current:void 0}))),_this2}return Mover_createClass(Mover,[{key:"dispose",value:function dispose(){var _this$_dummyManagner;this._onDispose(this),this._focusables={},this._unobserve&&(this._unobserve(),this._unobserve=void 0);var win=this._win();this._updateVisibleTimer&&(win.clearTimeout(this._updateVisibleTimer),this._updateVisibleTimer=void 0),this._domChangedTimer&&(win.clearTimeout(this._domChangedTimer),this._domChangedTimer=void 0),this._onChangeTimer&&(win.clearTimeout(this._onChangeTimer),this._onChangeTimer=void 0),null===(_this$_dummyManagner=this._dummyManagner)||void 0===_this$_dummyManagner||_this$_dummyManagner.dispose()}},{key:"setCurrent",value:function setCurrent(element){return this._current=element?new Utils.d(this._win,element):void 0,(this._props.trackState||this._props.visibilityAware)&&this._processOnChange(),!1}},{key:"getCurrent",value:function getCurrent(){var _this$_current;return(null===(_this$_current=this._current)||void 0===_this$_current?void 0:_this$_current.get())||null}},{key:"findNextTabbable",value:function findNextTabbable(current,prev){var container=this.getElement();if(!container||!container.contains(current))return null;var uncontrolled,tabster=this._tabster,focusable=tabster.focusable,next=null,onUncontrolled=function onUncontrolled(el){uncontrolled=el};if(this._props.tabbable&&(next=prev?focusable.findPrev({currentElement:current,container:container,onUncontrolled:onUncontrolled}):focusable.findNext({currentElement:current,container:container,onUncontrolled:onUncontrolled})),null===next){var parentElement=container.parentElement;if(parentElement){var parentCtx=Root_RootAPI.getTabsterContext(tabster,parentElement);if(parentCtx){var from=(prev?container:focusable.findLast({container:container}))||container;return FocusedElement_FocusedElementState.findNextTabbable(tabster,parentCtx,from,prev)}}}return{element:next,uncontrolled:uncontrolled}}},{key:"acceptElement",value:function acceptElement(element,state){var _this$_props=this._props,memorizeCurrent=_this$_props.memorizeCurrent,visibilityAware=_this$_props.visibilityAware;if(memorizeCurrent||visibilityAware){var container=this.getElement();if(container){if(memorizeCurrent){var _this$_current2,current=null===(_this$_current2=this._current)||void 0===_this$_current2?void 0:_this$_current2.get();if(current&&state.acceptCondition(current)&&state.from&&!container.contains(state.from))return state.found=!0,state.foundElement=current,NodeFilter.FILTER_ACCEPT}if(visibilityAware&&!container.contains(state.from)){var found,visible=Object.keys(this._visible);state.isForward||visible.reverse();for(var _i2=0,_visible=visible;_i2<_visible.length;_i2++){var _this$_focusables$_id,_id3=_visible[_i2],visibility=this._visible[_id3];if(visibility===Types.Visibilities.Visible||visibility===Types.Visibilities.PartiallyVisible&&(visibilityAware===Types.Visibilities.PartiallyVisible||!this._hasFullyVisible))if((found=null===(_this$_focusables$_id=this._focusables[_id3])||void 0===_this$_focusables$_id?void 0:_this$_focusables$_id.get())&&state.acceptCondition(found))return state.found=!0,state.foundElement=found,NodeFilter.FILTER_ACCEPT}}}}}},{key:"_observeState",value:function _observeState(){var _this3=this,element=this.getElement();if(!this._unobserve&&element&&"undefined"!=typeof MutationObserver){var observer=new MutationObserver((function(){var win=_this3._win();_this3._domChangedTimer&&win.clearTimeout(_this3._domChangedTimer),_this3._domChangedTimer=win.setTimeout(_this3._domChanged,0)}));observer.observe(element,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]}),this._unobserve=function(){observer.disconnect()}}}},{key:"forceUpdate",value:function forceUpdate(){this._processOnChange(!0)}},{key:"_processOnChange",value:function _processOnChange(force){var _this4=this;if(!this._onChangeTimer||force){var reallyProcessOnChange=function reallyProcessOnChange(){_this4._onChangeTimer=void 0;var changed=[];if(_this4._current!==_this4._prevCurrent&&(changed.push(_this4._current),changed.push(_this4._prevCurrent),_this4._prevCurrent=_this4._current),_this4._visible!==_this4._prevVisible){_this4._hasFullyVisible=!1;for(var _i3=0,_Object$keys2=Object.keys(_this4._visible);_i3<_Object$keys2.length;_i3++){var _id4=_Object$keys2[_i3],visibility=_this4._visible[_id4];visibility!==_this4._prevVisible[_id4]&&changed.push(_this4._focusables[_id4]),visibility===Types.Visibilities.Visible&&(_this4._hasFullyVisible=!0)}for(var _i4=0,_Object$keys3=Object.keys(_this4._prevVisible);_i4<_Object$keys3.length;_i4++){var _id5=_Object$keys3[_i4];_this4._visible[_id5]!==_this4._prevVisible[_id5]&&changed.push(_this4._focusables[_id5])}_this4._prevVisible=_this4._visible}for(var processed={},_i5=0,_changed=changed;_i5<_changed.length;_i5++){var weak=_changed[_i5],el=null==weak?void 0:weak.get(),_id6=el&&Object(Utils.l)(_this4._win,el);if(_id6&&!processed[_id6]&&(processed[_id6]=!0,_this4._focusables[_id6])){var props=_this4._props;if(el&&(void 0!==props.visibilityAware||props.trackState)){var state=_this4.getState(el);state&&Object(Utils.y)(el,Types.MoverEventName,state)}}}};this._onChangeTimer&&this._win().clearTimeout(this._onChangeTimer),force?reallyProcessOnChange():this._onChangeTimer=this._win().setTimeout(reallyProcessOnChange,0)}}},{key:"getState",value:function getState(element){var id=Object(Utils.l)(this._win,element);if(id in this._visible){var visibility=this._visible[id]||Types.Visibilities.Invisible;return{isCurrent:this._current?this._current.get()===element:void 0,visibility:visibility}}}},{key:"updateVisible",value:function updateVisible(updateParents){var _this5=this,element=this._element.get();if(!this._updateVisibleTimer&&element){if(updateParents)for(var e=element.parentElement;e;e=e.parentElement){var _getTabsterOnElement,_mover=null===(_getTabsterOnElement=getTabsterOnElement(this._tabster,e))||void 0===_getTabsterOnElement?void 0:_getTabsterOnElement.mover;_mover&&_mover.updateVisible(!1)}this._updateVisibleTimer=this._win().setTimeout((function(){_this5._updateVisibleTimer=void 0;for(var isChanged=!1,visibleMovers={},_i6=0,_Object$keys4=Object.keys(_this5._focusables);_i6<_Object$keys4.length;_i6++){var _id7=_Object$keys4[_i6],_element2=_this5._focusables[_id7].get(),visible=_element2?Object(Utils.s)(_this5._win,_element2,10):Types.Visibilities.Invisible,curIsVisible=_this5._visible[_id7]||Types.Visibilities.Invisible;visible!==Types.Visibilities.Invisible&&(visibleMovers[_id7]=visible),curIsVisible!==visible&&(isChanged=!0)}isChanged&&(_this5._prevVisible=_this5._visible,_this5._visible=visibleMovers,_this5._processOnChange())}),0)}}}]),Mover}(Utils.c);var Mover_MoverAPI=function(){function MoverAPI(_tabster,getWindow){var _this6=this;Mover_classCallCheck(this,MoverAPI),this._tabster=void 0,this._initTimer=void 0,this._win=void 0,this._scrollTimer=void 0,this._scrollTargets=[],this._movers=void 0,this._init=function(){_this6._initTimer=void 0;var win=_this6._win();win.addEventListener("scroll",_this6._onScroll,!0),win.addEventListener("keydown",_this6._onKeyDown,!0)},this._onMoverDispose=function(mover){delete _this6._movers[mover.id]},this._onFocus=function(e){for(var el=e;el;el=el.parentElement){var _getTabsterOnElement2,_mover2=null===(_getTabsterOnElement2=getTabsterOnElement(_this6._tabster,el))||void 0===_getTabsterOnElement2?void 0:_getTabsterOnElement2.mover;if(_mover2){_mover2.setCurrent(e);break}}},this._onScroll=function(e){var _step,isKnownTarget=!1,_iterator=Mover_createForOfIteratorHelper(_this6._scrollTargets);try{for(_iterator.s();!(_step=_iterator.n()).done;){if(_step.value===e.target){isKnownTarget=!0;break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}!isKnownTarget&&e.target.contains&&_this6._scrollTargets.push(e.target);var win=_this6._win();_this6._scrollTimer&&win.clearTimeout(_this6._scrollTimer),_this6._scrollTimer=win.setTimeout((function(){_this6._scrollTimer=void 0,_this6._updateVisible(_this6._scrollTargets),_this6._scrollTargets=[]}),200)},this._onKeyDown=function(e){var keyCode=e.keyCode;switch(keyCode){case Keys_Down:case Keys_Right:case Keys_Up:case Keys_Left:case Keys_PageDown:case Keys_PageUp:case Keys_Home:case Keys_End:case Keys_Tab:break;default:return}var tabster=_this6._tabster,focused=tabster.focusedElement.getFocusedElement();if(focused&&!_this6._isIgnoredInput(focused,keyCode)){var ctx=Root_RootAPI.getTabsterContext(tabster,focused,{checkRtl:!0});if(ctx&&ctx.mover&&!(ctx.isGroupperFirst&&ctx.groupper&&ctx.groupper.isActive())){var mover=ctx.mover,container=mover.getElement();if(container){var next,focusable=tabster.focusable,moverProps=mover.getProps(),direction=moverProps.direction||Types.MoverDirections.Both,isBoth=direction===Types.MoverDirections.Both,isVertical=isBoth||direction===Types.MoverDirections.Vertical,isHorizontal=isBoth||direction===Types.MoverDirections.Horizontal,isGrid=direction===Types.MoverDirections.Grid,isCyclic=moverProps.cyclic;if(!moverProps.disableHomeEndKeys||keyCode!==Keys_Home&&keyCode!==Keys_End){if(ctx.isRtl&&(keyCode===Keys_Right?keyCode=Keys_Left:keyCode===Keys_Left&&(keyCode=Keys_Right)),keyCode===Keys_Down&&isVertical||keyCode===Keys_Right&&isHorizontal)!(next=focusable.findNext({currentElement:focused,container:container}))&&isCyclic&&(next=focusable.findFirst({container:container}));else if(keyCode===Keys_Up&&isVertical||keyCode===Keys_Left&&isHorizontal)!(next=focusable.findPrev({currentElement:focused,container:container}))&&isCyclic&&(next=focusable.findLast({container:container}));else if(keyCode===Keys_Home)next=focusable.findFirst({container:container});else if(keyCode===Keys_End)next=focusable.findLast({container:container});else if(keyCode===Keys_PageUp){for(var prevElement=focusable.findPrev({currentElement:focused,container:container}),pageUpElement=null;prevElement;)pageUpElement=prevElement,prevElement=Object(Utils.r)(_this6._win,prevElement)?focusable.findPrev({currentElement:prevElement,container:container}):null;(next=pageUpElement)&&Object(Utils.u)(_this6._win,next,!1)}else if(keyCode===Keys_PageDown){for(var nextElement=focusable.findNext({currentElement:focused,container:container}),pageDownElement=null;nextElement;)pageDownElement=nextElement,nextElement=Object(Utils.r)(_this6._win,nextElement)?focusable.findNext({currentElement:nextElement,container:container}):null;(next=pageDownElement)&&Object(Utils.u)(_this6._win,next,!0)}else if(keyCode!==Keys_Tab||tabster.controlTab){if(isGrid){for(var lastElement,prevTop,fromRect=focused.getBoundingClientRect(),nextMethod=keyCode===Keys_Down||keyCode===Keys_Right?"findNext":"findPrev",el=focusable[nextMethod]({currentElement:focused,container:container});el;el=focusable[nextMethod]({currentElement:el,container:container})){var rect=el.getBoundingClientRect();if(keyCode===Keys_Up){if(rect.top<fromRect.top){if(void 0===prevTop)prevTop=rect.top;else if(rect.top<prevTop)break;if(rect.left<fromRect.left){next||(next=el);break}next=el}}else if(keyCode===Keys_Down){if(rect.top>fromRect.top){if(void 0===prevTop)prevTop=rect.top;else if(rect.top>prevTop)break;if(rect.left>fromRect.left){next||(next=el);break}next=el}}else if(keyCode===Keys_Left||keyCode===Keys_Right){next=el;break}lastElement=el}next||(next=lastElement)}}else{var _FocusedElementState$;next=null===(_FocusedElementState$=FocusedElement_FocusedElementState.findNextTabbable(tabster,ctx,focused,e.shiftKey))||void 0===_FocusedElementState$?void 0:_FocusedElementState$.element}var _dummyManagner;if(next)e.preventDefault(),e.stopImmediatePropagation(),Object(keyborg_esm.d)(next);else if(keyCode===Keys_Tab)null===(_dummyManagner=mover._dummyManagner)||void 0===_dummyManagner||_dummyManagner.moveOutWithDefaultAction(e.shiftKey)}}}}},this._tabster=_tabster,this._win=getWindow,this._initTimer=getWindow().setTimeout(this._init,0),this._movers={},_tabster.focusedElement.subscribe(this._onFocus)}return Mover_createClass(MoverAPI,[{key:"dispose",value:function dispose(){var _this7=this,win=this._win();this._tabster.focusedElement.unsubscribe(this._onFocus),this._initTimer&&(win.clearTimeout(this._initTimer),this._initTimer=void 0),this._scrollTimer&&(win.clearTimeout(this._scrollTimer),this._scrollTimer=void 0),win.removeEventListener("scroll",this._onScroll,!0),this._scrollTargets=[],win.removeEventListener("keydown",this._onKeyDown,!0),Object.keys(this._movers).forEach((function(moverId){_this7._movers[moverId]&&(_this7._movers[moverId].dispose(),delete _this7._movers[moverId])}))}},{key:"_updateVisible",value:function _updateVisible(scrolled){var _step2,containers={},_iterator2=Mover_createForOfIteratorHelper(scrolled);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)for(var s=_step2.value,_i8=0,_Object$keys6=Object.keys(this._movers);_i8<_Object$keys6.length;_i8++){var _id9=_Object$keys6[_i8],container=this._movers[_id9],containerElement=container.getElement();containerElement&&s.contains(containerElement)&&(containers[container.id]=container)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}for(var _i7=0,_Object$keys5=Object.keys(containers);_i7<_Object$keys5.length;_i7++){containers[_Object$keys5[_i7]].updateVisible(!1)}}},{key:"_isIgnoredInput",value:function _isIgnoredInput(element,keyCode){if(Object(Utils.t)(element,_inputSelector)&&("INPUT"===element.tagName||"TEXTAREA"===element.tagName)){var selectionStart=element.selectionStart||0;if(selectionStart!==(element.selectionEnd||0))return!0;if(selectionStart>0&&(keyCode===Keys_Left||keyCode===Keys_Up||keyCode===Keys_Home))return!0;if(selectionStart<(element.value||"").length&&(keyCode===Keys_Right||keyCode===Keys_Down||keyCode===Keys_End))return!0}return!1}}],[{key:"dispose",value:function dispose(instance){instance.dispose()}}]),MoverAPI}();function MutationEvent_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function MutationEvent_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MutationEvent_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MutationEvent_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function MutationEvent_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ObservedElement_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function ObservedElement_setPrototypeOf(o,p){return ObservedElement_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},ObservedElement_setPrototypeOf(o,p)}function ObservedElement_createSuper(Derived){var hasNativeReflectConstruct=function ObservedElement_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=ObservedElement_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=ObservedElement_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return ObservedElement_possibleConstructorReturn(this,result)}}function ObservedElement_possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function ObservedElement_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function ObservedElement_getPrototypeOf(o){return ObservedElement_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},ObservedElement_getPrototypeOf(o)}Mover_MoverAPI.createMover=function(tabster,element,props){var self=tabster.mover,newMover=new Mover_Mover(tabster,element,self._onMoverDispose,props);return self._movers[newMover.id]=newMover,newMover};var ObservedElement_ObservedElementAPI=function(_Subscribable){!function ObservedElement_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&ObservedElement_setPrototypeOf(subClass,superClass)}(ObservedElementAPI,_Subscribable);var _super=ObservedElement_createSuper(ObservedElementAPI);function ObservedElementAPI(tabster){var _this;return function ObservedElement_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ObservedElementAPI),(_this=_super.call(this))._win=void 0,_this._tabster=void 0,_this._initTimer=void 0,_this._waiting={},_this._lastRequestFocusId=0,_this._observedById={},_this._observedByName={},_this._currentRequest=void 0,_this._currentRequestTimestamp=0,_this._init=function(){_this._initTimer=void 0,_this._tabster.focusedElement.subscribe(_this._onFocus)},_this._onFocus=function(e){if(e){var current=_this._currentRequest;if(current){Date.now()-_this._currentRequestTimestamp>=300&&(delete _this._currentRequest,current.cancel())}}},_this.onObservedElementUpdate=function(element){var _getTabsterOnElement,observed=null===(_getTabsterOnElement=getTabsterOnElement(_this._tabster,element))||void 0===_getTabsterOnElement?void 0:_getTabsterOnElement.observed,uid=Object(Utils.l)(_this._win,element),info=_this._observedById[uid];if(observed&&Object(Utils.j)(element.ownerDocument,element)){info||(info=_this._observedById[uid]={element:new Utils.d(_this._win,element)});var observedName=observed.name,prevName=info.prevName;if(observedName!==prevName){if(prevName){var _obn=_this._observedByName[prevName];_obn&&_obn[uid]&&(Object.keys(_obn).length>1?delete _obn[uid]:delete _this._observedByName[prevName])}info.prevName=observedName}var obn=_this._observedByName[observedName];obn||(obn=_this._observedByName[observedName]={}),obn[uid]=info,_this._waitConditional(observedName)}else if(info){var _prevName=info.prevName;if(_prevName){var _obn2=_this._observedByName[_prevName];_obn2&&_obn2[uid]&&(Object.keys(_obn2).length>1?delete _obn2[uid]:delete _this._observedByName[_prevName])}delete _this._observedById[uid]}},_this._tabster=tabster,_this._win=tabster.getWindow,_this._initTimer=_this._win().setTimeout(_this._init,0),_this}return function ObservedElement_createClass(Constructor,protoProps,staticProps){return protoProps&&ObservedElement_defineProperties(Constructor.prototype,protoProps),staticProps&&ObservedElement_defineProperties(Constructor,staticProps),Constructor}(ObservedElementAPI,[{key:"dispose",value:function dispose(){var win=this._win();this._initTimer&&(win.clearTimeout(this._initTimer),this._initTimer=void 0),this._tabster.focusedElement.unsubscribe(this._onFocus);for(var _i=0,_Object$keys=Object.keys(this._waiting);_i<_Object$keys.length;_i++){var key=_Object$keys[_i];this._rejectWaiting(key)}this._observedById={},this._observedByName={}}},{key:"_rejectWaiting",value:function _rejectWaiting(key,shouldResolve){var w=this._waiting[key];if(w){var win=this._win();w.timer&&win.clearTimeout(w.timer),w.conditionTimer&&win.clearTimeout(w.conditionTimer),!shouldResolve&&w.reject?w.reject():shouldResolve&&w.resolve&&w.resolve(null),delete this._waiting[key]}}},{key:"getElement",value:function getElement(observedName,accessibility){var o=this._observedByName[observedName];if(o)for(var _i2=0,_Object$keys2=Object.keys(o);_i2<_Object$keys2.length;_i2++){var _uid=_Object$keys2[_i2],el=o[_uid].element.get()||null;return el?(accessibility===Types.ObservedElementAccesibilities.Accessible&&!this._tabster.focusable.isAccessible(el)||accessibility===Types.ObservedElementAccesibilities.Focusable&&!this._tabster.focusable.isFocusable(el,!0))&&(el=null):(delete o[_uid],delete this._observedById[_uid]),el}return null}},{key:"waitElement",value:function waitElement(observedName,timeout,accessibility){var _this2=this,el=this.getElement(observedName,accessibility);if(el)return{result:Object(Utils.o)(this._win).resolve(el),cancel:function cancel(){}};var key=(accessibility===Types.ObservedElementAccesibilities.Accessible?"a":accessibility===Types.ObservedElementAccesibilities.Focusable?"f":"_")+observedName,w=this._waiting[key];if(w&&w.request)return w.request;w=this._waiting[key]={timer:this._win().setTimeout((function(){w.conditionTimer&&_this2._win().clearTimeout(w.conditionTimer),delete _this2._waiting[key],w.resolve&&w.resolve(null)}),timeout)};var promise=new(Object(Utils.o)(this._win))((function(resolve,reject){w.resolve=resolve,w.reject=reject}));return w.request={result:promise,cancel:function cancel(){_this2._rejectWaiting(key,!0)}},accessibility&&this.getElement(observedName)&&this._waitConditional(observedName),w.request}},{key:"requestFocus",value:function requestFocus(observedName,timeout){var _this3=this,requestId=++this._lastRequestFocusId,currentRequestFocus=this._currentRequest;currentRequestFocus&&currentRequestFocus.cancel();var request=this.waitElement(observedName,timeout,Types.ObservedElementAccesibilities.Focusable);return this._currentRequest=request,this._currentRequestTimestamp=Date.now(),request.result.finally((function(){_this3._currentRequest===request&&delete _this3._currentRequest})),{result:request.result.then((function(element){return!(_this3._lastRequestFocusId!==requestId||!element)&&_this3._tabster.focusedElement.focus(element,!0)})),cancel:function cancel(){request.cancel()}}}},{key:"_waitConditional",value:function _waitConditional(observedName){var _this4=this,waitingElementKey="_"+observedName,waitingAccessibleElementKey="a"+observedName,waitingFocusableElementKey="f"+observedName,waitingElement=this._waiting[waitingElementKey],waitingAccessibleElement=this._waiting[waitingAccessibleElementKey],waitingFocusableElement=this._waiting[waitingFocusableElementKey],win=this._win(),resolve=function resolve(element,key,waiting,accessibility){var _getTabsterOnElement2,observed=null===(_getTabsterOnElement2=getTabsterOnElement(_this4._tabster,element))||void 0===_getTabsterOnElement2?void 0:_getTabsterOnElement2.observed;observed&&observed.name===observedName&&(waiting.timer&&win.clearTimeout(waiting.timer),delete _this4._waiting[key],waiting.resolve&&waiting.resolve(element),_this4.trigger(element,{name:observedName,details:observed.details,accessibility:accessibility}))};if(waitingElement){var element=this.getElement(observedName);element&&Object(Utils.j)(element.ownerDocument,element)&&resolve(element,waitingElementKey,waitingElement,Types.ObservedElementAccesibilities.Any)}if(waitingAccessibleElement&&!waitingAccessibleElement.conditionTimer){!function resolveAccessible(){var element=_this4.getElement(observedName);element&&Object(Utils.j)(element.ownerDocument,element)&&_this4._tabster.focusable.isAccessible(element)?resolve(element,waitingAccessibleElementKey,waitingAccessibleElement,Types.ObservedElementAccesibilities.Accessible):waitingAccessibleElement.conditionTimer=win.setTimeout(resolveAccessible,100)}()}if(waitingFocusableElement&&!waitingFocusableElement.conditionTimer){!function resolveFocusable(){var element=_this4.getElement(observedName);element&&Object(Utils.j)(element.ownerDocument,element)&&_this4._tabster.focusable.isFocusable(element,!0)?resolve(element,waitingFocusableElementKey,waitingFocusableElement,Types.ObservedElementAccesibilities.Focusable):waitingFocusableElement.conditionTimer=win.setTimeout(resolveFocusable,100)}()}}}],[{key:"dispose",value:function dispose(instance){instance.dispose()}}]),ObservedElementAPI}(Subscribable);function Outline_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Outline_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Outline_createClass(Constructor,protoProps,staticProps){return protoProps&&Outline_defineProperties(Constructor.prototype,protoProps),staticProps&&Outline_defineProperties(Constructor,staticProps),Constructor}var _fullScreenEventName,_fullScreenElementName,defaultProps={areaClass:"tabster-focus-outline-area",outlineClass:"tabster-focus-outline",outlineColor:"#ff4500",outlineWidth:2,zIndex:2147483647},_props=defaultProps;"undefined"!=typeof document&&("onfullscreenchange"in document?(_fullScreenEventName="fullscreenchange",_fullScreenElementName="fullscreenElement"):"onwebkitfullscreenchange"in document?(_fullScreenEventName="webkitfullscreenchange",_fullScreenElementName="webkitFullscreenElement"):"onmozfullscreenchange"in document?(_fullScreenEventName="mozfullscreenchange",_fullScreenElementName="mozFullScreenElement"):"onmsfullscreenchange"in document&&(_fullScreenEventName="msfullscreenchange",_fullScreenElementName="msFullscreenElement"));var OutlinePosition=function(){function OutlinePosition(left,top,right,bottom){Outline_classCallCheck(this,OutlinePosition),this.left=void 0,this.top=void 0,this.right=void 0,this.bottom=void 0,this.left=left,this.top=top,this.right=right,this.bottom=bottom}return Outline_createClass(OutlinePosition,[{key:"equalsTo",value:function equalsTo(other){return this.left===other.left&&this.top===other.top&&this.right===other.right&&this.bottom===other.bottom}},{key:"clone",value:function clone(){return new OutlinePosition(this.left,this.top,this.right,this.bottom)}}]),OutlinePosition}(),Outline_OutlineAPI=function(){function OutlineAPI(tabster){var _this=this;Outline_classCallCheck(this,OutlineAPI),this._tabster=void 0,this._win=void 0,this._initTimer=void 0,this._updateTimer=void 0,this._outlinedElement=void 0,this._curPos=void 0,this._isVisible=!1,this._curOutlineElements=void 0,this._allOutlineElements=[],this._fullScreenElement=void 0,this._init=function(){_this._initTimer=void 0,_this._tabster.keyboardNavigation.subscribe(_this._onKeyboardNavigationStateChanged),_this._tabster.focusedElement.subscribe(_this._onFocus);var win=_this._win();win.addEventListener("scroll",_this._onScroll,!0),_fullScreenEventName&&win.document.addEventListener(_fullScreenEventName,_this._onFullScreenChanged)},this._onFullScreenChanged=function(e){if(_fullScreenElementName&&e.target){var target=e.target.body||e.target,outlineElements=_this._getDOM(target);if(target.ownerDocument&&outlineElements){var fsElement=target.ownerDocument[_fullScreenElementName];fsElement?(fsElement.appendChild(outlineElements.container),_this._fullScreenElement=fsElement):(target.ownerDocument.body.appendChild(outlineElements.container),_this._fullScreenElement=void 0)}}},this._onKeyboardNavigationStateChanged=function(){_this._onFocus(_this._tabster.focusedElement.getFocusedElement())},this._onFocus=function(e){!_this._updateElement(e)&&_this._isVisible&&_this._setVisibility(!1)},this._onScroll=function(e){_this._outlinedElement&&OutlineAPI._isParentChild(e.target,_this._outlinedElement)&&(_this._curPos=void 0,_this._setOutlinePosition())},this._tabster=tabster,this._win=tabster.getWindow,this._initTimer=this._win().setTimeout(this._init,0)}return Outline_createClass(OutlineAPI,[{key:"setup",value:function setup(props){_props=Object.assign({},_props,props);var win=this._win();win.__tabsterOutline||(win.__tabsterOutline={}),win.__tabsterOutline.style||(win.__tabsterOutline.style=appendStyles(win.document,_props)),props&&props.areaClass?win.document.body.classList.remove(defaultProps.areaClass):win.document.body.classList.add(defaultProps.areaClass)}},{key:"dispose",value:function dispose(){var _this2=this,win=this._win();this._initTimer&&(win.clearTimeout(this._initTimer),this._initTimer=void 0),this._updateTimer&&(win.clearTimeout(this._updateTimer),this._updateTimer=void 0),this._tabster.keyboardNavigation.unsubscribe(this._onKeyboardNavigationStateChanged),this._tabster.focusedElement.unsubscribe(this._onFocus),win.removeEventListener("scroll",this._onScroll,!0),_fullScreenEventName&&win.document.removeEventListener(_fullScreenEventName,this._onFullScreenChanged),this._allOutlineElements.forEach((function(outlineElements){return _this2._removeDOM(outlineElements.container)})),this._allOutlineElements=[],delete this._outlinedElement,delete this._curPos,delete this._curOutlineElements,delete this._fullScreenElement}},{key:"_shouldShowCustomOutline",value:function _shouldShowCustomOutline(element){var tabsterOnElement=getTabsterOnElement(this._tabster,element);if(tabsterOnElement&&tabsterOnElement.outline&&tabsterOnElement.outline.isIgnored)return!1;for(var i=element;i;i=i.parentElement)if(i.classList&&i.classList.contains(_props.areaClass))return!0;return!1}},{key:"_updateElement",value:function _updateElement(e){if(this._outlinedElement=void 0,this._updateTimer&&(this._win().clearTimeout(this._updateTimer),this._updateTimer=void 0),this._curPos=void 0,!this._tabster.keyboardNavigation.isNavigatingWithKeyboard())return!1;if(e){if("INPUT"===e.tagName){if(!(e.type in{button:!0,checkbox:!0,file:!0,image:!0,radio:!0,range:!0,reset:!0,submit:!0}))return!1}else if("TEXTAREA"===e.tagName||"true"===e.contentEditable||"IFRAME"===e.tagName)return!1;return!!this._shouldShowCustomOutline(e)&&(this._tabster.keyboardNavigation.isNavigatingWithKeyboard()&&(this._outlinedElement=e,this._updateOutline()),!0)}return!1}},{key:"_updateOutline",value:function _updateOutline(){var _this3=this;this._setOutlinePosition(),this._updateTimer&&(this._win().clearTimeout(this._updateTimer),this._updateTimer=void 0),this._outlinedElement&&(this._updateTimer=this._win().setTimeout((function(){_this3._updateTimer=void 0,_this3._updateOutline()}),30))}},{key:"_setVisibility",value:function _setVisibility(visible){this._isVisible=visible,this._curOutlineElements&&(visible?this._curOutlineElements.container.classList.add(_props.outlineClass+"_visible"):(this._curOutlineElements.container.classList.remove(_props.outlineClass+"_visible"),this._curPos=void 0))}},{key:"_setOutlinePosition",value:function _setOutlinePosition(){if(this._outlinedElement){var boundingRect=Object(Utils.k)(this._win,this._outlinedElement),position=new OutlinePosition(boundingRect.left,boundingRect.top,boundingRect.right,boundingRect.bottom);if(!this._curPos||!position.equalsTo(this._curPos)){var outlineElements=this._getDOM(this._outlinedElement),win=this._outlinedElement.ownerDocument&&this._outlinedElement.ownerDocument.defaultView;if(outlineElements&&win){this._curOutlineElements!==outlineElements&&(this._setVisibility(!1),this._curOutlineElements=outlineElements),this._curPos=position;var p=position.clone(),hasAbsolutePositionedParent=!1,hasFixedPositionedParent=!1,container=outlineElements.container,scrollingElement=container&&container.ownerDocument&&container.ownerDocument.scrollingElement;if(scrollingElement){for(var parent=this._outlinedElement.parentElement;parent&&parent!==this._fullScreenElement;parent=parent.parentElement){boundingRect=Object(Utils.k)(this._win,parent);var _win=parent.ownerDocument&&parent.ownerDocument.defaultView;if(!_win)return;var computedStyle=_win.getComputedStyle(parent),_position=computedStyle.position;"absolute"===_position?hasAbsolutePositionedParent=!0:"fixed"!==_position&&"sticky"!==_position||(hasFixedPositionedParent=!0),"visible"!==computedStyle.overflow&&((hasAbsolutePositionedParent||hasFixedPositionedParent)&&"hidden"!==computedStyle.overflow||(boundingRect.left>p.left&&(p.left=boundingRect.left),boundingRect.top>p.top&&(p.top=boundingRect.top),boundingRect.right<p.right&&(p.right=boundingRect.right),boundingRect.bottom<p.bottom&&(p.bottom=boundingRect.bottom)))}var allRect=Object(Utils.k)(this._win,scrollingElement),allWidth=allRect.left+allRect.right,allHeight=allRect.top+allRect.bottom,ow=_props.outlineWidth;p.left=p.left>ow?p.left-ow:0,p.top=p.top>ow?p.top-ow:0,p.right=p.right<allWidth-ow?p.right+ow:allWidth,p.bottom=p.bottom<allHeight-ow?p.bottom+ow:allHeight;var width=p.right-p.left,height=p.bottom-p.top;if(width>2*ow&&height>2*ow){var leftBorderNode=outlineElements.left,topBorderNode=outlineElements.top,rightBorderNode=outlineElements.right,bottomBorderNode=outlineElements.bottom,sx=this._fullScreenElement||hasFixedPositionedParent?0:win.pageXOffset,sy=this._fullScreenElement||hasFixedPositionedParent?0:win.pageYOffset;container.style.position=hasFixedPositionedParent?"fixed":"absolute",container.style.background=_props.outlineColor,leftBorderNode.style.width=rightBorderNode.style.width=topBorderNode.style.height=bottomBorderNode.style.height=_props.outlineWidth+"px",leftBorderNode.style.left=topBorderNode.style.left=bottomBorderNode.style.left=p.left+sx+"px",rightBorderNode.style.left=p.left+sx+width-ow+"px",leftBorderNode.style.top=rightBorderNode.style.top=topBorderNode.style.top=p.top+sy+"px",bottomBorderNode.style.top=p.top+sy+height-ow+"px",leftBorderNode.style.height=rightBorderNode.style.height=height+"px",topBorderNode.style.width=bottomBorderNode.style.width=width+"px",this._setVisibility(!0)}else this._setVisibility(!1)}}}}}},{key:"_getDOM",value:function _getDOM(contextElement){var doc=contextElement.ownerDocument,win=doc&&doc.defaultView;if(doc&&win&&win.__tabsterOutline){if(win.__tabsterOutline.style||(win.__tabsterOutline.style=appendStyles(doc,_props)),!win.__tabsterOutline.elements){var outlineElements={container:doc.createElement("div"),left:doc.createElement("div"),top:doc.createElement("div"),right:doc.createElement("div"),bottom:doc.createElement("div")};outlineElements.container.className=_props.outlineClass,outlineElements.left.className=_props.outlineClass+"__left",outlineElements.top.className=_props.outlineClass+"__top",outlineElements.right.className=_props.outlineClass+"__right",outlineElements.bottom.className=_props.outlineClass+"__bottom",outlineElements.container.appendChild(outlineElements.left),outlineElements.container.appendChild(outlineElements.top),outlineElements.container.appendChild(outlineElements.right),outlineElements.container.appendChild(outlineElements.bottom),doc.body.appendChild(outlineElements.container),win.__tabsterOutline.elements=outlineElements,this._allOutlineElements.push(outlineElements)}return win.__tabsterOutline.elements}}},{key:"_removeDOM",value:function _removeDOM(contextElement){var win=contextElement.ownerDocument&&contextElement.ownerDocument.defaultView,outline=win&&win.__tabsterOutline;if(outline){outline.style&&outline.style.parentNode&&(outline.style.parentNode.removeChild(outline.style),delete outline.style);var outlineElements=outline&&outline.elements;outlineElements&&(outlineElements.container.parentNode&&outlineElements.container.parentNode.removeChild(outlineElements.container),delete outline.elements)}}}],[{key:"dispose",value:function dispose(instance){instance.dispose()}},{key:"_isParentChild",value:function _isParentChild(parent,child){return child===parent||!!(parent.compareDocumentPosition(child)&document.DOCUMENT_POSITION_CONTAINED_BY)}}]),OutlineAPI}();function appendStyles(document,props){var style=document.createElement("style");return style.type="text/css",style.appendChild(document.createTextNode(function getOutlineStyles(props){return"\n."+props.areaClass+" *, ."+props.areaClass+" *:focus {\noutline: none !important;\n}\n\n."+props.outlineClass+" {\ndisplay: none;\nposition: absolute;\nwidth: 0;\nheight: 0;\nleft: 0;\ntop: 0;\nz-index: "+props.zIndex+";\n}\n\n."+props.outlineClass+"."+props.outlineClass+"_visible {\ndisplay: block;\n}\n\n."+props.outlineClass+"__left,\n."+props.outlineClass+"__top,\n."+props.outlineClass+"__right,\n."+props.outlineClass+"__bottom {\nposition: absolute;\nbackground: inherit;\n}"}(props))),document.head.appendChild(style),style}var UncontrolledAPI=function UncontrolledAPI(){!function Uncontrolled_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UncontrolledAPI)};function Tabster_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function Tabster_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Tabster_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tabster_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function Tabster_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Tabster_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Tabster_Tabster=function(){function Tabster(win,props){var _props$controlTab,_this=this;!function Tabster_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Tabster),this._storage=void 0,this._unobserve=void 0,this._win=void 0,this._forgetMemorizedTimer=void 0,this._forgetMemorizedElements=[],this._version="1.0.7",this._noop=!1,this.keyboardNavigation=void 0,this.focusedElement=void 0,this.focusable=void 0,this.root=void 0,this.uncontrolled=void 0,this.controlTab=void 0,this.internal=void 0,this.groupper=void 0,this.mover=void 0,this.outline=void 0,this.deloser=void 0,this.modalizer=void 0,this.observedElement=void 0,this.crossOrigin=void 0,this.groupperDispose=void 0,this.moverDispose=void 0,this.outlineDispose=void 0,this.rootDispose=void 0,this.deloserDispose=void 0,this.modalizerDispose=void 0,this.observedElementDispose=void 0,this.crossOriginDispose=void 0,this.createRoot=void 0,this.updateRoot=void 0,this.createGroupper=void 0,this.createMover=void 0,this.createDeloser=void 0,this.createModalizer=void 0,this.updateObserved=void 0,this.updateModalizer=void 0,this.getWindow=function(){if(!_this._win)throw new Error("Using disposed Tabster.");return _this._win},this._storage=Object(Utils.h)(win),this._win=win;var getWindow=this.getWindow;this.keyboardNavigation=new KeyboardNavigation_KeyboardNavigationState(getWindow),this.focusedElement=new FocusedElement_FocusedElementState(this,getWindow),this.focusable=new Focusable_FocusableAPI(this,getWindow),this.root=new Root_RootAPI(this,null==props?void 0:props.autoRoot),this.createRoot=Root_RootAPI.createRoot,this.updateRoot=function(root,removed){Root_RootAPI.onRoot(_this.root,root,removed)},this.uncontrolled=new UncontrolledAPI,this.controlTab=null===(_props$controlTab=null==props?void 0:props.controlTab)||void 0===_props$controlTab||_props$controlTab,this.internal={stopObserver:function stopObserver(){_this._unobserve&&(_this._unobserve(),delete _this._unobserve)},resumeObserver:function resumeObserver(syncState){if(!_this._unobserve){var doc=getWindow().document;_this._unobserve=function observeMutations(doc,tabster,updateTabsterByAttribute,syncState){if("undefined"==typeof MutationObserver)return function(){};var elementByUId,getWindow=tabster.getWindow;function updateTabsterElements(node,removed){elementByUId||(elementByUId=Object(Utils.m)(getWindow).elementByUId),processNode(node,removed);var walker=Object(Utils.g)(doc,node,(function(element){return processNode(element,removed)}));if(walker)for(;walker.nextNode(););}function processNode(element,removed){if(!element.getAttribute)return NodeFilter.FILTER_SKIP;var _elementByUId,_elementByUId$uid,uid=element.__tabsterElementUID;return uid&&elementByUId&&(removed?delete elementByUId[uid]:null!==(_elementByUId$uid=(_elementByUId=elementByUId)[uid])&&void 0!==_elementByUId$uid||(_elementByUId[uid]=new Utils.d(getWindow,element))),(getTabsterOnElement(tabster,element)||element.hasAttribute(Types.TabsterAttributeName))&&updateTabsterByAttribute(tabster,element,removed),NodeFilter.FILTER_SKIP}var observer=new MutationObserver((function onMutation(mutations){var _step,_iterator=MutationEvent_createForOfIteratorHelper(mutations);try{for(_iterator.s();!(_step=_iterator.n()).done;){var mutation=_step.value,target=mutation.target,removed=mutation.removedNodes,added=mutation.addedNodes;if("attributes"===mutation.type)mutation.attributeName===Types.TabsterAttributeName&&updateTabsterByAttribute(tabster,target);else{for(var i=0;i<removed.length;i++)updateTabsterElements(removed[i],!0);for(var _i=0;_i<added.length;_i++)updateTabsterElements(added[_i])}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}));return syncState&&updateTabsterElements(getWindow().document.body),observer.observe(doc,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[Types.TabsterAttributeName]}),function(){observer.disconnect()}}(doc,_this,Instance_updateTabsterByAttribute,syncState)}}},this.internal.resumeObserver(!1),Object(Utils.w)(getWindow)}return function Tabster_createClass(Constructor,protoProps,staticProps){return protoProps&&Tabster_defineProperties(Constructor.prototype,protoProps),staticProps&&Tabster_defineProperties(Constructor,staticProps),Constructor}(Tabster,[{key:"dispose",value:function dispose(){this.internal.stopObserver();var win=this._win;this._forgetMemorizedElements=[],win&&this._forgetMemorizedTimer&&(win.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer);var _step,disposeParts={outlineDispose:["outline"],crossOriginDispose:["crossOrigin"],deloserDispose:["deloser","createDeloser"],groupperDispose:["groupper","createGroupper"],moverDispose:["mover","createMover"],modalizerDispose:["modalizer","createModalizer","updateModalizer"],observedElementDispose:["observedElement","updateObserved"]},_iterator=Tabster_createForOfIteratorHelper(Object.keys(disposeParts));try{for(_iterator.s();!(_step=_iterator.n()).done;){var key=_step.value,disposeFunc=this[key];if(disposeFunc){disposeFunc();var _step2,_iterator2=Tabster_createForOfIteratorHelper(disposeParts[key]);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var partKey=_step2.value;this[partKey]&&delete this[partKey]}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}delete this[key]}}}catch(err){_iterator.e(err)}finally{_iterator.f()}KeyboardNavigation_KeyboardNavigationState.dispose(this.keyboardNavigation),Focusable_FocusableAPI.dispose(this.focusable),FocusedElement_FocusedElementState.dispose(this.focusedElement),Root_RootAPI.dispose(this.root),Object(Utils.x)(this.getWindow),Object(Utils.f)(this.getWindow),this._storage=new WeakMap,win&&(Object(Utils.i)(win),delete win.__tabsterInstance,delete this._win)}},{key:"storageEntry",value:function storageEntry(element,addremove){var storage=this._storage,entry=storage.get(element);return entry?!1===addremove&&0===Object.keys(entry).length&&storage.delete(element):!0===addremove&&(entry={},storage.set(element,entry)),entry}}],[{key:"dispose",value:function dispose(instance){instance.dispose()}},{key:"forceCleanup",value:function forceCleanup(tabster){tabster._win&&(tabster._forgetMemorizedElements.push(tabster._win.document.body),tabster._forgetMemorizedTimer||(tabster._forgetMemorizedTimer=tabster._win.setTimeout((function(){delete tabster._forgetMemorizedTimer;for(var el=tabster._forgetMemorizedElements.shift();el;el=tabster._forgetMemorizedElements.shift())Object(Utils.f)(tabster.getWindow,el),FocusedElement_FocusedElementState.forgetMemorized(tabster.focusedElement,el)}),0),Object(Utils.e)(tabster.getWindow,!0)))}}]),Tabster}();function createTabster(win,props){var existingAh=getCurrentTabster(win);if(existingAh)return existingAh;var tabster=new Tabster_Tabster(win,props);return win.__tabsterInstance=tabster,tabster}function getGroupper(tabster){var tabsterInternal=tabster;if(!tabsterInternal.groupper){var groupper=new Groupper_GroupperAPI(tabster,tabsterInternal.getWindow);tabsterInternal.groupper=groupper,tabsterInternal.createGroupper=Groupper_GroupperAPI.createGroupper,tabsterInternal.groupperDispose=function(){Groupper_GroupperAPI.dispose(groupper)}}return tabsterInternal.groupper}function getMover(tabster){var tabsterInternal=tabster;if(!tabsterInternal.mover){var mover=new Mover_MoverAPI(tabster,tabsterInternal.getWindow);tabsterInternal.mover=mover,tabsterInternal.createMover=Mover_MoverAPI.createMover,tabsterInternal.moverDispose=function(){Mover_MoverAPI.dispose(mover)}}return tabsterInternal.mover}function getOutline(tabster){var tabsterInternal=tabster;if(!tabsterInternal.outline){var outline=new Outline_OutlineAPI(tabster);tabsterInternal.outline=outline,tabsterInternal.outlineDispose=function(){Outline_OutlineAPI.dispose(outline)}}return tabsterInternal.outline}function Tabster_getDeloser(tabster,props){var tabsterInternal=tabster;if(!tabsterInternal.deloser){var deloser=new Deloser_DeloserAPI(tabster,props);tabsterInternal.deloser=deloser,tabsterInternal.createDeloser=Deloser_DeloserAPI.createDeloser,tabsterInternal.deloserDispose=function(){Deloser_DeloserAPI.dispose(deloser)}}return tabsterInternal.deloser}function getModalizer(tabster){var tabsterInternal=tabster;if(!tabsterInternal.modalizer){var modalizer=new Modalizer_ModalizerAPI(tabster);tabsterInternal.modalizer=modalizer,tabsterInternal.createModalizer=Modalizer_ModalizerAPI.createModalizer,tabsterInternal.updateModalizer=function(modalizer,removed){Modalizer_ModalizerAPI.updateModalizer(tabsterInternal,modalizer,removed)},tabsterInternal.modalizerDispose=function(){Modalizer_ModalizerAPI.dispose(modalizer)}}return tabsterInternal.modalizer}function getObservedElement(tabster){var tabsterInternal=tabster;if(!tabsterInternal.observedElement){var observedElement=new ObservedElement_ObservedElementAPI(tabster);tabsterInternal.observedElement=observedElement,tabsterInternal.updateObserved=observedElement.onObservedElementUpdate,tabsterInternal.observedElementDispose=function(){ObservedElement_ObservedElementAPI.dispose(observedElement)}}return tabsterInternal.observedElement}function getTabsterAttribute(props,plain){var _ref,attr=JSON.stringify(props);return!0===plain?attr:((_ref={})[Types.TabsterAttributeName]=attr,_ref)}function getCurrentTabster(win){return win.__tabsterInstance}}},[[506,2,3]]]);
//# sourceMappingURL=main.356d87ff.iframe.bundle.js.map